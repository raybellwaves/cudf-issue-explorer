{"assignees":[],"author":{"id":"MDQ6VXNlcjE2MDA1Njkw","is_bot":false,"login":"vuule","name":"Vukasin Milovanovic"},"body":"**Problem:**\r\nThe protocol writer classes take a pointer to a vector and use it as the output buffer. Writes change the size of this vector. This vector is also modified (including size changes) outside of the writers. The ORC/Parquet writers have a `std::vector` data member that is reused for protocol writes and manually reset between uses. ORC writer also reuses the `ProtobufWriter` object. In addition, Parquet writer reuses the output buffer to output data unrelated to `CompactProtocolWriter`. All this makes the use error-prone.\r\n\r\n**Solution proposal:**\r\nModify the protocol writer API to use an internal output buffer and only provide getters for it. Also, protocol writer objects should not be reused (and cannot, with the proposed API). There shouldn't be a buffer data member in `xyz::writer::impl`.\r\nThese changes would limit the scope of the state to functions instead of the lifetime of `xyz::writer::impl` objects.","closed":false,"closedAt":null,"comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc4MDA5MzUyNA==","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been marked stale due to no recent activity in the past 30d. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be marked rotten if there is no activity in the next 60d.","createdAt":"2021-02-16T20:19:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/7015#issuecomment-780093524","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4MDg5ODA1OA==","author":{"login":"vuule"},"authorAssociation":"CONTRIBUTOR","body":"Issue still relevant.","createdAt":"2021-02-17T22:31:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/7015#issuecomment-780898058","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgwMzQ0Nzg3OQ==","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2021-03-20T19:13:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/7015#issuecomment-803447879","viewerDidAuthor":false}],"createdAt":"2020-12-15T22:20:23Z","id":"MDU6SXNzdWU3NjgyNTQ0MDk=","labels":[{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMTg1MjQ0MTQy","name":"cuIO","description":"cuIO issue","color":"fef2c0"},{"id":"MDU6TGFiZWwyNTQ2NTIxMDI0","name":"improvement","description":"Improvement / enhancement to an existing function","color":"bfd4f2"}],"milestone":null,"number":7015,"projectCards":[{"project":{"name":"Feature Planning"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"`CompactProtocolWriter` and `ProtobufWriter` API provide no encapsulation of the output buffer","updatedAt":"2024-02-23T18:43:18Z","url":"https://github.com/rapidsai/cudf/issues/7015"}
