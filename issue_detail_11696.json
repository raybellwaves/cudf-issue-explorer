{"assignees":[],"author":{"id":"MDQ6VXNlcjU2MDczMzA=","is_bot":false,"login":"mythrocks","name":"MithunR"},"body":"In its current implementation, the `Scalar` Java class does not consider the `scale` of a scalar value, when comparing two `DECIMAL` scalars.\r\n\r\nHere is the section of `Scalar.equals()` that compares `DECIMAL64` values:\r\n```java\r\n    case DECIMAL64:\r\n      return getLong() == other.getLong();\r\n```\r\n`getLong()` does not rescale the representative value of the scalar, based on a common scale. This implementation will equate two `DECIMAL64` scalars of different scales, if their `rep` values are equal.\r\n\r\nA similar argument could be made for `Scalar.hashCode()`:\r\n```java\r\n      case DECIMAL64:\r\n      // ...\r\n        valueHash = Long.hashCode(getLong());\r\n        break;\r\n```\r\n\r\nAFAICT, the problem applies to `DECIMAL32` and `DECIMAL64`, but not `DECIMAL128`. In adding support for `DECIMAL128` in #11645, the comparisons are made using `BigDecimal`, rather than `BigInteger`.","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5KWbxN","author":{"login":"mythrocks"},"authorAssociation":"CONTRIBUTOR","body":"Closing this as invalid; both `hashCode()` and `equals()` are correct.\r\n\r\n1. `Scalar.hashCode()` returns `Objects.hashCode(type, valueHash)`. `type` includes the scale.\r\n2. `Scalar.equals()` compares `type` first, before proceeding to compare values. `type`, again, includes the scale.\r\n\r\nApologies for the noise. This bug is invalid.","createdAt":"2022-09-14T23:18:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/11696#issuecomment-1247394893","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5MRUJv","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2022-10-15T00:16:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/11696#issuecomment-1279607407","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5Mofyo","author":{"login":"revans2"},"authorAssociation":"CONTRIBUTOR","body":"This would sill be good to fix","createdAt":"2022-10-20T14:52:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/11696#issuecomment-1285684392","viewerDidAuthor":false}],"createdAt":"2022-09-13T18:42:01Z","id":"I_kwDOBWUGps5RxPmp","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWw1OTk2MjY1NjM=","name":"invalid","description":"This doesn't seem right","color":"e4e669"},{"id":"MDU6TGFiZWwxNDA1MTQ1NjIz","name":"cuDF (Java)","description":"Affects Java cuDF API.","color":"006b75"}],"milestone":null,"number":11696,"projectCards":[{"project":{"name":"Bug Squashing"},"column":{"name":"Needs prioritizing"}},{"project":{"name":"v22.12 Release"},"column":{"name":"Issue-Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] Java `Scalar` does not consider Decimal scale for `.hashCode()`/`.equals()`","updatedAt":"2022-10-20T15:04:49Z","url":"https://github.com/rapidsai/cudf/issues/11696"}
