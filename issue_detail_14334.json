{"assignees":[],"author":{"id":"MDQ6VXNlcjI0MzAxOTQ4","is_bot":false,"login":"marcimarc1","name":"Marc"},"body":"Hi, \r\n\r\nI am currently doing some feature engineering on a timeseries. My index is a datetime and I want to apply a rolling window. \r\nFYI the pandas code is running. \r\n`df['feature'] = df['feature'].rolling(f'{120}s', center=True, min_periods=1).sum()`\r\n\r\nwhich leads to the following error: \r\n\r\n`NotImplementedError: center is not implemented for offset-based windows`\r\n\r\nbasically, I want to change to cudf for runtime optimization. As I have a datetime as an index, rolling operation with centring is much appreciated due to the fact of handling missing values, just shifting by timestamp is not trivial as discussed [here.](https://github.com/pandas-dev/pandas/issues/20012) \r\n\r\nI would appreciate if you could take a look. (Maybe it occurs due to some changes in the API interface)\r\n","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5qdAge","author":{"login":"bdice"},"authorAssociation":"CONTRIBUTOR","body":"Thanks for this feature request! I'm not familiar with the behavior of `center=True`. Can you help identify what formulas might be needed to center a window? Would you be interested in collaborating on a PR for adding this feature in cudf?","createdAt":"2023-10-30T20:30:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/14334#issuecomment-1785989150","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5qogJN","author":{"login":"marcimarc1"},"authorAssociation":"NONE","body":"Thanks for the reply @bdice.\r\nTbh, I am not familiar with how it is efficiently implemented, and I just started using GPU accelerated data preprocessing and I am at no point contributing well-written code here (basically I am exploring the rapids stack right now). \r\nI just know that in pandas the `center`,  it is forwarded to the [Window Class](https://github.com/pandas-dev/pandas/blob/main/pandas/core/window/rolling.py#L882).  \r\nUsually, `center` helps when working with timeseries data, that is indexed by a timestamp and there might be missing values. If the indexing is consistent, you can just shift the generated value by the `window_size / 2` and end up with a centered value (in my example, if there would be no missing value, and my `delta_t` between the timestamps is 1 second, this should hold: \r\n\r\n`df['feature'].rolling(f'{120}s', center=True, min_periods=1).sum() == df['feature'].rolling(f'{120}s',  min_periods=1).sum().shift(60)`\r\n\r\nDid this help you? ","createdAt":"2023-11-01T13:56:42Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/14334#issuecomment-1789002317","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5qxQqt","author":{"login":"mroeschke"},"authorAssociation":"CONTRIBUTOR","body":"In pandas, `center` just shifts the start/end bounds before performing the rolling aggregation. For reference:\r\n\r\nFor fixed windows e.g. `window=2`\r\n\r\nhttps://github.com/pandas-dev/pandas/blob/4e5576d13ab1929aaab9bcc45689939f6d82e178/pandas/core/indexers/objects.py#L105\r\n\r\nFor variable windows e.g. `window=\"2s\"`\r\n\r\nhttps://github.com/pandas-dev/pandas/blob/4e5576d13ab1929aaab9bcc45689939f6d82e178/pandas/_libs/window/indexers.pyx#L92","createdAt":"2023-11-02T18:21:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/rapidsai/cudf/issues/14334#issuecomment-1791298221","viewerDidAuthor":false}],"createdAt":"2023-10-26T16:19:44Z","id":"I_kwDOBWUGps51DvLy","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":null,"number":14334,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[FEA] center implementation for rolling window","updatedAt":"2023-11-02T18:21:16Z","url":"https://github.com/rapidsai/cudf/issues/14334"}
