{"assignees":[],"author":{"id":"MDQ6VXNlcjI0ODQ0NzA1","is_bot":false,"login":"mlahir1","name":"Lahir Marni"},"body":"The following exception is thrown when a column of type 'int' is written using to_parquet, and read with read_parquet and re-written with to-parquet again.\r\n\r\nSo, the first to_parquet is changing the `int` col type to catg, but when reading again, and the same file is re-written it fails.\r\n\r\nException: ValueError: 'category' column dtypes are currently not supported by the gpu accelerated parquet writer\r\n\r\nReproducer Code:\r\n```\r\nimport cudf\r\ndf = cudf.DataFrame()\r\n\r\ndf['a'] = [0 , 0 , 0, 1]\r\ndf['b'] = [0 , 0 , 0, 1]\r\n\r\ndf['a']  = df.a.astype('int')\r\ndf.to_parquet('test', partition_cols=['a'], partition_file_name=f'0.parquet')\r\ndf = cudf.read_parquet('test/a=0/0.parquet')\r\ndf.to_parquet('test.pq')\r\n```","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps4-iw-3","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2022-02-23T23:03:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10115#issuecomment-1049300919","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5FP6ID","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2022-06-21T14:08:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10115#issuecomment-1161798147","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5Xz73f","author":{"login":"Pedrexus"},"authorAssociation":"NONE","body":"any update on this part? Is it possible to be implemented?","createdAt":"2023-03-17T06:28:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10115#issuecomment-1473232351","viewerDidAuthor":false}],"createdAt":"2022-01-24T22:45:20Z","id":"I_kwDOBWUGps5CWmue","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMTg1MjQ0MTQy","name":"cuIO","description":"cuIO issue","color":"fef2c0"}],"milestone":null,"number":10115,"projectCards":[{"project":{"name":"Bug Squashing"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] ValueError: 'category' column dtypes are currently not supported by the gpu accelerated parquet writer","updatedAt":"2024-02-23T18:43:06Z","url":"https://github.com/rapidsai/cudf/issues/10115"}
