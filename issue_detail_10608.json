{"assignees":[],"author":{"id":"MDQ6VXNlcjExNjY0MjU5","is_bot":false,"login":"galipremsagar","name":"GALI PREM SAGAR"},"body":"**Describe the bug**\r\nWhen `fill_values`'s dtype actually is mismatching with a column's dtype, we should raise an error as we don't support mixed types(`'object'`) like in pandas. Pandas is returning a mixed `object` dtypes when there is a mismatch of column dtype & `fill_value` dtype in `1.4.x`\r\n\r\n**Steps/Code to reproduce bug**\r\n```python\r\n>>> import pandas as pd\r\n>>> import pandas as pd\r\n>>> s = pd.DataFrame()\r\n>>> s['a'] = [1, 2, 3, 4, 5]\r\n>>> s['b'] = pd.Series([10, 11, 12, 13, 14], dtype='datetime64[ns]')\r\n>>> s.groupby('a').shift(1500, fill_value=10)\r\n    b\r\n0  10\r\n1  10\r\n2  10\r\n3  10\r\n4  10\r\n>>> s.groupby('a').shift(1500, fill_value=10).dtypes\r\nb    object\r\ndtype: object\r\n>>> import cudf\r\n>>> gs = cudf.from_pandas(s)\r\n>>> gs.groupby('a').shift(1500, fill_value=10)\r\n                              b\r\n0 1970-01-01 00:00:00.000000010\r\n1 1970-01-01 00:00:00.000000010\r\n2 1970-01-01 00:00:00.000000010\r\n3 1970-01-01 00:00:00.000000010\r\n4 1970-01-01 00:00:00.000000010\r\n>>> gs.groupby('a').shift(1500, fill_value=10).dtypes\r\nb    datetime64[ns]\r\ndtype: object\r\n```\r\n**Expected behavior**\r\nFew possible solutions:\r\n1. Raise error that mixed types are not possible like we do in other places of code-base.\r\n2. If we do 1, users will want a way fill values based on dtypes or column names. So expanding `fill_value` to be a dictionary of fill values that can be used to fill values based on dtype like: {\"str\": \"abc\", \"int64\": 10, ....} or based on columns like: {\"a\":\"abc\", \"b\": 10, ...}\r\n\r\nIn a way, this is both a bug & feature request.\r\n\r\n**Environment overview (please complete the following information)**\r\n - Environment location: [Bare-metal]\r\n - Method of cuDF install: [from source]\r\n\r\n","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5CYVjk","author":{"login":"isVoid"},"authorAssociation":"CONTRIBUTOR","body":"Do we know what workflow will it disable once we raise the error for mixed dtypes? If we don't know, can we implement this in two steps: first PR raises the error and wait for user feedbacks for a better API design?","createdAt":"2022-04-29T20:03:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10608#issuecomment-1113676004","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5D-uTa","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2022-05-29T20:03:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10608#issuecomment-1140516058","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5JRR6-","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2022-08-27T21:02:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10608#issuecomment-1229266622","viewerDidAuthor":false}],"createdAt":"2022-04-06T16:40:14Z","id":"I_kwDOBWUGps5HOBFW","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":null,"number":10608,"projectCards":[{"project":{"name":"v22.12 Release"},"column":{"name":"Issue-P1"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] Passing `fill_value` in `groupby.shift` with a mismatching dtype must result in error","updatedAt":"2024-02-23T18:42:46Z","url":"https://github.com/rapidsai/cudf/issues/10608"}
