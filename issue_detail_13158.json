{"assignees":[],"author":{"id":"U_kgDOBkXLWQ","is_bot":false,"login":"alexbarghi-nv","name":"Alex Barghi"},"body":"**Describe the bug**\r\nGiven a cudf Series _s_, calling `torch.as_tensor(s, device='cuda')` should properly use `__cuda_array_interface__` to create a tensor without copying the series.  This usually works, but sometimes, the following error is thrown:\r\n```\r\nRuntimeError: The specified pointer resides on host memory and is not registered with any CUDA device.\r\n```\r\n\r\nThis error recently caused our CI to fail, as shown here: https://github.com/rapidsai/cugraph/actions/runs/4723055386/jobs/8381931370?pr=3455#step:7:3639\r\n","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5bDwzd","author":{"login":"wence-"},"authorAssociation":"CONTRIBUTOR","body":"This error occurs somewhere in torch, it calls `cudaPointerGetAttributes` on the pointer passed into torch, but somehow this is returning attribute data that says that the pointer is a host one. I don't know enough about torch to even find the path through `as_tensor` to see how this is happening.","createdAt":"2023-04-28T15:09:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/13158#issuecomment-1527712989","viewerDidAuthor":false}],"createdAt":"2023-04-17T21:56:15Z","id":"I_kwDOBWUGps5jqQ6t","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMDEzOTg3MzUy","name":"0 - Backlog","description":"In queue waiting for assignment","color":"d4c5f9"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":null,"number":13158,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] Calling torch.as_tensor on cudf Series Fails Intermittently","updatedAt":"2023-06-07T20:52:27Z","url":"https://github.com/rapidsai/cudf/issues/13158"}
