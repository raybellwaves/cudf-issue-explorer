{"assignees":[],"author":{"id":"MDQ6VXNlcjM2MjczNzc=","is_bot":false,"login":"jangorecki","name":"Jan Gorecki"},"body":"Value I am trying to compute is a range between two measure variables `v1, v2` within groups defined by `id2, id4` categories.\r\nThe following pandas/dask syntax could work\r\n```py\r\nans = x.groupby(['id2','id4']).agg({'v1': 'max', 'v2': 'min'}).assign(range_v1_v2=lambda x: x['v1'] - x['v2'])[['range_v1_v2']]\r\n#  File \"pyarrow/array.pxi\", line 536, in pyarrow.lib.Array.from_pandas\r\n#  File \"pyarrow/array.pxi\", line 176, in pyarrow.lib.array\r\n#  File \"pyarrow/array.pxi\", line 85, in pyarrow.lib._ndarray_to_array\r\n#  File \"pyarrow/error.pxi\", line 81, in pyarrow.lib.check_status\r\n#pyarrow.lib.ArrowInvalid: Only 1D arrays accepted\r\n```\r\nreproducible example\r\n```py\r\nimport os\r\nimport gc\r\nimport cudf as cu\r\nver = cu.__version__\r\nprint(ver)\r\n#0.8.0+0.g8fa7bd3.dirty\r\nsrc_grp = \"G1_1e7_1e2_0_0.csv\"\r\nx = cu.read_csv(src_grp, skiprows=1,\r\n                names=['id1','id2','id3','id4','id5','id6','v1','v2','v3'],\r\n                dtype=['str','str','str','int','int','int','int','int','float'])\r\nans = x.groupby(['id2','id4']).agg({'v1': 'max', 'v2': 'min'}).assign(range_v1_v2=lambda x: x['v1'] - x['v2'])[['range_v1_v2']]\r\n```\r\ngenerate data according to https://github.com/rapidsai/cudf/issues/2494","closed":false,"closedAt":null,"comments":[{"id":"MDEyOklzc3VlQ29tbWVudDUyMTcxODQzOA==","author":{"login":"shwina"},"authorAssociation":"CONTRIBUTOR","body":"Thanks for reporting, @jangorecki. It looks like the underlying issue here is that cudf `assign` doesn't yet work with callable arguments.","createdAt":"2019-08-15T17:05:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/2591#issuecomment-521718438","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDcyMTE1Nzk1Ng==","author":{"login":"edwintyh"},"authorAssociation":"NONE","body":"Hello, I was wondering if this feature has been implemented?","createdAt":"2020-11-03T14:43:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/rapidsai/cudf/issues/2591#issuecomment-721157956","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDcyMTI4ODI1Mw==","author":{"login":"kkraus14"},"authorAssociation":"COLLABORATOR","body":"I don't believe that `assign` supports lambdas still. Contributions welcome!","createdAt":"2020-11-03T18:00:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/2591#issuecomment-721288253","viewerDidAuthor":false}],"createdAt":"2019-08-15T09:19:19Z","id":"MDU6SXNzdWU0ODEwNjY1NzI=","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":{"number":5,"title":"Pandas API Alignment and Coverage","description":"","dueOn":null},"number":2591,"projectCards":[{"project":{"name":"Bug Squashing"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"Support callables in DataFrame.assign","updatedAt":"2022-07-12T00:19:16Z","url":"https://github.com/rapidsai/cudf/issues/2591"}
