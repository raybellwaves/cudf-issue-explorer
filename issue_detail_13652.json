{"assignees":[{"id":"MDQ6VXNlcjExMjY5ODE=","login":"wence-","name":"Lawrence Mitchell"}],"author":{"id":"MDQ6VXNlcjExMjY5ODE=","is_bot":false,"login":"wence-","name":"Lawrence Mitchell"},"body":"**Describe the bug**\r\n\r\nWhen a frame's index is a `CategoricalIndex` that is _ordered_, looking up an array-like list of indices fails with `TypeError: Merging on categorical variables with mismatched ordering is ambiguous`.\r\n\r\nThis occurs because to perform the merge between the index and the to-be-looked-up values (to find matches), the values are turned into a categorical column, but the default category dtype is un-ordered.\r\n\r\n**Steps/Code to reproduce bug**\r\n```python\r\nimport cudf\r\ns = cudf.Series([1, 2, 3, 4, 5], index=cudf.CategoricalIndex([1, 2, 3, 4, 5], categories=[1, 2, 3, 4, 5], ordered=True))\r\ns.loc[[1, 4]] # => KeyError\r\n```\r\n\r\n**Expected behavior**\r\n\r\n```python\r\ns.to_pandas().loc[[1, 4]]\r\n# 1    1\r\n# 4    4\r\n# dtype: int64\r\n```\r\n\r\nI note actually that pandas doesn't care at all about ordered-ness of categoricals in lookup. Which kind of makes sense because you're just looking up values.\r\n\r\nSo probably the solution is to merge the decategorized index column with the asked-for labels.","closed":false,"closedAt":null,"comments":[],"createdAt":"2023-07-03T12:04:54Z","id":"I_kwDOBWUGps5qdNrE","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMDEzOTg3NTAz","name":"2 - In Progress","description":"Currently a work in progress","color":"fef2c0"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":{"number":5,"title":"Pandas API Alignment and Coverage","description":"","dueOn":null},"number":13652,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] loc-based indexing fails when looking up array like with ordered categorical index","updatedAt":"2023-07-05T16:41:38Z","url":"https://github.com/rapidsai/cudf/issues/13652"}
