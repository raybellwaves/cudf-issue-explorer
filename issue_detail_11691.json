{"assignees":[{"id":"MDQ6VXNlcjE2MDA1Njkw","login":"vuule","name":"Vukasin Milovanovic"}],"author":{"id":"MDQ6VXNlcjc0MTY5MzU=","is_bot":false,"login":"ttnghia","name":"Nghia Truong"},"body":"Similar to https://github.com/rapidsai/cudf/issues/11525 that has just been fixed, I discovered new failures with ORC reader/writer. \r\n\r\nNote that these failures are wrong days, not wrong seconds like previously reported in https://github.com/rapidsai/cudf/issues/11525.\r\n\r\n```\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(1132, 8, 4, 22, 50, 7, 153267)\r\ngpu = datetime.datetime(1132, 8, 11, 22, 50, 7, 153267)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(1132, 8, 4, 22, 50, 7, 153267)\r\ngpu = datetime.datetime(1132, 8, 11, 22, 50, 7, 153267)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(1132, 8, 4, 22, 50, 7, 153267)\r\ngpu = datetime.datetime(1132, 8, 11, 22, 50, 7, 153267)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(1132, 8, 4, 22, 50, 7, 153267)\r\ngpu = datetime.datetime(1132, 8, 11, 22, 50, 7, 153267)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(833, 6, 4, 10, 18, 10, 135672)\r\ngpu = datetime.datetime(833, 6, 8, 10, 18, 10, 135672)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(833, 6, 4, 10, 18, 10, 135672)\r\ngpu = datetime.datetime(833, 6, 8, 10, 18, 10, 135672)\r\n\r\ncpu = datetime.datetime(833, 6, 4, 10, 18, 10, 135672)\r\ngpu = datetime.datetime(833, 6, 8, 10, 18, 10, 135672)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(833, 6, 4, 10, 18, 10, 135672)\r\ngpu = datetime.datetime(833, 6, 8, 10, 18, 10, 135672)\r\n\r\ncpu = datetime.datetime(1132, 8, 4, 22, 50, 7, 153267)\r\ngpu = datetime.datetime(1132, 8, 11, 22, 50, 7, 153267)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(1132, 8, 4, 22, 50, 7, 153267)\r\ngpu = datetime.datetime(1132, 8, 11, 22, 50, 7, 153267)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n\r\ncpu = datetime.datetime(833, 6, 4, 10, 18, 10, 135672)\r\ngpu = datetime.datetime(833, 6, 8, 10, 18, 10, 135672)\r\n\r\ncpu = datetime.datetime(740, 7, 19, 10, 16, 58, 929621)\r\ngpu = datetime.datetime(740, 7, 23, 10, 16, 58, 929621)\r\n\r\ncpu = datetime.datetime(487, 4, 15, 11, 13, 37, 361058)\r\ngpu = datetime.datetime(487, 4, 16, 11, 13, 37, 361058)\r\n\r\ncpu = datetime.datetime(833, 6, 4, 10, 18, 10, 135672)\r\ngpu = datetime.datetime(833, 6, 8, 10, 18, 10, 135672)\r\n\r\ncpu = datetime.datetime(1348, 1, 31, 3, 21, 2, 422651)\r\ngpu = datetime.datetime(1348, 2, 8, 3, 21, 2, 422651)\r\n```","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5KM7Qt","author":{"login":"ttnghia"},"authorAssociation":"CONTRIBUTOR","body":"@vuule @GregoryKimball Can you test with pandas for the examples above, please? `cpu =...` should be the ground true.","createdAt":"2022-09-13T05:04:51Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/11691#issuecomment-1244902445","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5KO7Ui","author":{"login":"jlowe"},"authorAssociation":"MEMBER","body":"Curious, does this only happen for dates before the [Julian-Gregorian calendar transition in 1582](https://www.timeanddate.com/calendar/julian-gregorian-switch.html)?","createdAt":"2022-09-13T13:37:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/rapidsai/cudf/issues/11691#issuecomment-1245426978","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5KPgL_","author":{"login":"ttnghia"},"authorAssociation":"CONTRIBUTOR","body":"Yeah the tests failed only for years before that year.","createdAt":"2022-09-13T15:27:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/11691#issuecomment-1245577983","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5KUFXn","author":{"login":"wence-"},"authorAssociation":"CONTRIBUTOR","body":"> Yeah the tests failed only for years before that year.\r\n\r\nThis is probably more complicated because the transition took ballpark 300 years, so really one needs to interpret the time relative to a location and government to be precise (timezone is not enough if it is only numeric because, for example, Finland has the same timezone as Moscow, but switched calendar 200 years earlier).","createdAt":"2022-09-14T13:37:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/11691#issuecomment-1246778855","viewerDidAuthor":false}],"createdAt":"2022-09-13T05:01:13Z","id":"I_kwDOBWUGps5RtaD0","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMDEzOTg3MzUy","name":"0 - Backlog","description":"In queue waiting for assignment","color":"d4c5f9"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMTg1MjQ0MTQy","name":"cuIO","description":"cuIO issue","color":"fef2c0"}],"milestone":{"number":23,"title":"ORC continuous improvement","description":"","dueOn":null},"number":11691,"projectCards":[{"project":{"name":"Bug Squashing"},"column":{"name":"Needs prioritizing"}},{"project":{"name":"v23.02 Release"},"column":{"name":"Issue-P1"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] ORC read/write is wrong in `day` values in pre-1582 datetime values","updatedAt":"2023-04-02T22:39:26Z","url":"https://github.com/rapidsai/cudf/issues/11691"}
