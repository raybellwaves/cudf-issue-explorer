{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNTIxMDA4","is_bot":false,"login":"isVoid","name":"Michael Wang"},"body":"**Is your feature request related to a problem? Please describe.**\r\nCurrently if one attempts to explicitly materialize a cupy array via cudf.RangeIndex, this error is thrown:\r\n```\r\n(Pdb) import cudf\r\n(Pdb) cp.asarray(cudf.RangeIndex(0, 100))\r\n*** TypeError: Implicit conversion to a host NumPy array via __array__ is not allowed, To explicitly construct a GPU matrix, consider using .to_cupy()\r\nTo explicitly construct a host matrix, consider using .to_numpy().\r\n```\r\n\r\nOffline discussion with @vyasr and @pentschev suggests that we should have this usage working transparently. The benefit of this is that `cp.asarray(obj)` would work for all cudf objects.\r\n\r\n**Describe the solution you'd like**\r\nThe most straight forward way is to enable `RangeIndex.__array__`, which is currently disabled. The rationale is that when `__array__` is invoked, the intention of converting to numpy array is clear. However, additional care should be taken when it's being invoked within a cuDF API. According to @vyasr , we should leverage the frame tracking tooling to check if the `__array__` interface is invoked internally in cuDF, or externally. If the former, we should raise an error and suggest that `to_cupy` method should be used. If the latter, the API should work, but maybe a warning can be thrown suggesting this is not as efficient as `to_cupy`.\r\n","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps58fm71","author":{"login":"er-eis"},"authorAssociation":"CONTRIBUTOR","body":"if in either case we want the user to call `to_cupy`, why not call it directly in `__array__`?","createdAt":"2024-05-01T15:47:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/15618#issuecomment-2088660725","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps59IvE-","author":{"login":"vyasr"},"authorAssociation":"CONTRIBUTOR","body":"Apologies for the slow response here. The main reason not to call it directly in `__array__` is that it would be surprising to users if `np.asarray(cudf.RangeIndex(...))` returned a cupy array instead of a numpy array, especially since there are types that are representable in cudf and in numpy but not in cupy so the above conversion would actually fail if we implicitly converted to cupy instead of numpy.","createdAt":"2024-05-07T22:56:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/rapidsai/cudf/issues/15618#issuecomment-2099441982","viewerDidAuthor":false}],"createdAt":"2024-04-30T04:04:00Z","id":"I_kwDOBWUGps6HVGWM","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":15618,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[FEA] Enable `cp.asarray(cudf.RangeIndex)`","updatedAt":"2024-05-07T22:56:23Z","url":"https://github.com/rapidsai/cudf/issues/15618"}
