{"assignees":[{"id":"MDQ6VXNlcjE2MDA1Njkw","login":"vuule","name":"Vukasin Milovanovic"}],"author":{"id":"MDQ6VXNlcjI0ODQ0NzA1","is_bot":false,"login":"mlahir1","name":"Lahir Marni"},"body":"```\r\nIn [2]: import cudf\r\n\r\nIn [3]: cudf.read_orc('tsrepro.orc')\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\nCell In[3], line 1\r\n----> 1 cudf.read_orc('tsrepro.orc')\r\n\r\nFile /conda/envs/rapids-23.02/lib/python3.10/site-packages/cudf/io/orc.py:370, in read_orc(filepath_or_buffer, engine, columns, filters, stripes, skiprows, num_rows, use_index, timestamp_type, use_python_file_object, storage_options, bytes_per_thread)\r\n    366         stripes = selected_stripes\r\n    368 if engine == \"cudf\":\r\n    369     return DataFrame._from_data(\r\n--> 370         *liborc.read_orc(\r\n    371             filepaths_or_buffers,\r\n    372             columns,\r\n    373             stripes,\r\n    374             skiprows,\r\n    375             num_rows,\r\n    376             use_index,\r\n    377             timestamp_type,\r\n    378         )\r\n    379     )\r\n    380 else:\r\n    382     def read_orc_stripe(orc_file, stripe, columns):\r\n\r\nFile orc.pyx:84, in cudf._lib.orc.read_orc()\r\n\r\nFile orc.pyx:121, in cudf._lib.orc.read_orc()\r\n\r\nRuntimeError: CUDF failure at: /opt/conda/conda-bld/work/cpp/src/io/orc/timezone.cpp:138: Failed to open the timezone file.\r\n```\r\n\r\n[tsrepro.orc.zip](https://github.com/rapidsai/cudf/files/10946593/tsrepro.orc.zip)\r\n","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5XWgB9","author":{"login":"karthikeyann"},"authorAssociation":"CONTRIBUTOR","body":"Please share the environment details.\r\n\r\n**Environment overview (please complete the following information)**\r\n - Environment location: [Bare-metal, Docker, Cloud(specify cloud provider)]\r\n - Method of cuDF install: [conda, Docker, or from source]\r\n   - If method of install is [Docker], provide `docker pull` & `docker run` commands used\r\n\r\n**Environment details**\r\nPlease run and paste the output of the `cudf/print_env.sh` script here, to gather any other relevant environment details\r\n","createdAt":"2023-03-13T05:03:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/12926#issuecomment-1465516157","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5XZzlx","author":{"login":"mlahir1"},"authorAssociation":"NONE","body":"Environment location: Docker.\r\nMethod of cuDF install: conda\r\n\r\noutput of  print_env.sh is attached. \r\n[env.txt](https://github.com/rapidsai/cudf/files/10959041/env.txt)\r\n\r\nSame issue happens with 23.04 nightly too. \r\n","createdAt":"2023-03-13T15:37:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/12926#issuecomment-1466382705","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5XarK7","author":{"login":"karthikeyann"},"authorAssociation":"CONTRIBUTOR","body":"is it your own dockerfile?\r\n\r\nTry installing `tzdata` in your dockerfile\r\n`apt-get install --reinstall tzdata`\r\n","createdAt":"2023-03-13T17:41:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/12926#issuecomment-1466610363","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5XbeRN","author":{"login":"mlahir1"},"authorAssociation":"NONE","body":"reinstall tzdata fixed it, i will add that to the docker file.","createdAt":"2023-03-13T19:26:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/rapidsai/cudf/issues/12926#issuecomment-1466819661","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5Xbgio","author":{"login":"karthikeyann"},"authorAssociation":"CONTRIBUTOR","body":"Keeping this open to provide a method to use `tzdata` package installed via conda, in orc reader.\r\n\r\n@vuule Right now, tzif_system_directory is hardcoded to `\"/usr/share/zoneinfo/\"` https://github.com/rapidsai/cudf/blob/276bcf4171c82101a12b3d2392802e4746d0d2e3/cpp/src/io/orc/timezone.cpp#L27  \r\n when cudf installed conda, `tzdata` package is installed but orc reader cannot access it now. Alternate path in conda is `$CONDA_PREFIX/share/zoneinfo`, it should be accessible by orc reader.","createdAt":"2023-03-13T19:33:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/12926#issuecomment-1466828968","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5XbhXE","author":{"login":"vuule"},"authorAssociation":"CONTRIBUTOR","body":"Understood.\r\nShould we default to `/usr/share/zoneinfo/`, but fall back to `$CONDA_PREFIX/share/zoneinfo` if the default dir fails?","createdAt":"2023-03-13T19:36:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/12926#issuecomment-1466832324","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5XoRL_","author":{"login":"vyasr"},"authorAssociation":"CONTRIBUTOR","body":"I'm guessing we'd want the reverse? We generally prefer conda files (libraries/headers/whatever) inside a conda environment to system files.","createdAt":"2023-03-15T15:05:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/rapidsai/cudf/issues/12926#issuecomment-1470173951","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5XqIVI","author":{"login":"vuule"},"authorAssociation":"CONTRIBUTOR","body":"Sounds good. I'll make the change after the refactor PR is merged.","createdAt":"2023-03-15T19:16:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/12926#issuecomment-1470661960","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps51Hg2J","author":{"login":"GregoryKimball"},"authorAssociation":"CONTRIBUTOR","body":"I believe this is closed. @vuule please feel free to re-open if I'm mistaken.","createdAt":"2024-02-26T18:47:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/12926#issuecomment-1964903817","viewerDidAuthor":false}],"createdAt":"2023-03-13T02:21:39Z","id":"I_kwDOBWUGps5gmQVi","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMDEzOTg3MzUy","name":"0 - Backlog","description":"In queue waiting for assignment","color":"d4c5f9"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMTg1MjQ0MTQy","name":"cuIO","description":"cuIO issue","color":"fef2c0"}],"milestone":null,"number":12926,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] Issues while loading TimeStamp columns","updatedAt":"2024-03-02T02:32:16Z","url":"https://github.com/rapidsai/cudf/issues/12926"}
