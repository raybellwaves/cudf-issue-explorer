{"assignees":[],"author":{"id":"MDQ6VXNlcjc0Mzc4MTgx","is_bot":false,"login":"liuyangc1","name":""},"body":"I want to create a new column, which is the first non-null value of several columns, I used the function [coalesce()](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/coalesce) in dplyr to achieve that by simply run ` data %>% mutate(d = coalesce(a, b, c))`, in Dask CPU, I run below code to achieve that\r\n```\r\nd = {'a': [1, 2, 3, None, 5, 1, None, None, None, None, 3, None, 5, 6, 7], \\\r\n     'b': [1, 2, 3, 200, 5, 1, 200, None, 400, None, 3, None, 5, 6, 7], \\\r\n     'c': [1, 2, 3, None, 5, 1, 300, 300, None, 600, 3, 300, 5, 6, 7]} \r\n\r\ndf2 = pd.DataFrame(d)\r\n\r\nddf2 = dd.from_pandas(df2,npartitions=50)\r\nddf2['d'] = ddf2['a'].copy().fillna(ddf2['b']).fillna(ddf2['c'])\r\nddf2.compute()\r\n```\r\nHowever, in dask cuDF, when I am trying to use the fillna() to acheive my intent, I got the error message\r\n```\r\nd = {'id': ['a', 'a','a','a','a','b','b','b','b','b','c','c','c','c','c'], \\\r\n     'time': ['1', '2', '4', '3', '5', '1', '2', '3', '4', '5','1', '2', '3', '4', '5'], \\\r\n     'a': [1, 2, 3, None, 5, 1, None, None, None, None, 3, None, 5, 6, 7], \\\r\n     'b': [1, 2, 3, 200, 5, 1, 200, None, 400, None, 3, None, 5, 6, 7], \\\r\n     'c': [1, 2, 3, None, 5, 1, 300, 300, None, 600, 3, 300, 5, 6, 7]} \r\n\r\ndf = pd.DataFrame(data=d)\r\ngdf = cudf.DataFrame.from_pandas(df)\r\n\r\nddf = dask_cudf.from_cudf(gdf, npartitions=4)\r\n\r\nddf['d'] = ddf['a'].copy().fillna(ddf['b']).fillna(ddf['c'])\r\nddf.compute()\r\n```\r\nerror message: `RuntimeError: cuDF failure at: /opt/conda/envs/rapids/conda-bld/libcudf_1598487636199/work/cpp/src/replace/replace.cu:804: Column size mismatch`\r\n\r\nSo I am wondering if there are functions that allows me to get the first non-null value from several columns in cuDF or if we can add that.","closed":false,"closedAt":null,"comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc4MDA5NDI3OA==","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been marked stale due to no recent activity in the past 30d. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be marked rotten if there is no activity in the next 60d.","createdAt":"2021-02-16T20:20:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/6759#issuecomment-780094278","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4OTM2MDIyNA==","author":{"login":"randerzander"},"authorAssociation":"CONTRIBUTOR","body":"Still a valid [FEA]","createdAt":"2021-03-03T01:43:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/6759#issuecomment-789360224","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg1MTc3MDUzOQ==","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2021-06-01T03:03:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/6759#issuecomment-851770539","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg1MjE4Nzc0NQ==","author":{"login":"revans2"},"authorAssociation":"CONTRIBUTOR","body":"Still valid","createdAt":"2021-06-01T14:48:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/6759#issuecomment-852187745","viewerDidAuthor":false}],"createdAt":"2020-11-12T21:16:22Z","id":"MDU6SXNzdWU3NDE5MzM1Mzc=","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxMDEzOTg3MzUy","name":"0 - Backlog","description":"In queue waiting for assignment","color":"d4c5f9"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"},{"id":"MDU6TGFiZWwxMTg1MjQwODk4","name":"dask","description":"Dask issue","color":"fcc25d"}],"milestone":null,"number":6759,"projectCards":[{"project":{"name":"Feature Planning"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[FEA]Coalesce(), find the first non-null value, no equivalent function in RAPIDS","updatedAt":"2021-06-01T15:06:09Z","url":"https://github.com/rapidsai/cudf/issues/6759"}
