{"assignees":[{"id":"MDQ6VXNlcjMxOTA0MDU=","login":"shwina","name":"Ashwin Srinath"}],"author":{"id":"MDQ6VXNlcjcwNjAzMjc0","is_bot":false,"login":"amanlai","name":"Manlai Amar"},"body":"Suppose I have a Series as follows:\r\n```python\r\ns = cudf.Series(range(100), index=cudf.date_range('2024', periods=100, freq='D'))\r\n```\r\nIf I want to perform 3-day rolling window mean, I can do:\r\n```python\r\nwindow_size = 3\r\ns.rolling(f'{window_size}D').mean()\r\n```\r\nThis is not centered. If I want to set the window labels as the center of the window index (like in pandas):\r\n```python\r\na = s.rolling(f'{window_size}D', center=True).mean()\r\n```\r\nthen I get a NotImplementedError.\r\n\r\nI wish I could do this in cudf.\r\n\r\nRight now, I can just compute the rolling mean, shift it by half the window size and fill in the NaN values by using a loop over a variable window but it's a little ugly.\r\n```python\r\nshift = -(window_size-1)//2\r\nb = s.rolling(f'{window_size}D').mean().shift(shift)\r\nb.iloc[shift:] = [s.loc[i:].mean() for i in s.index[-window_size+1:-window_size-shift+1]]\r\n```\r\n\r\nPandas' `DataFrame.rolling` uses a cython optimized function to implement `center` (and `closed`) parameters. Its function to get variable window indexers is `pandas._libs.window.indexers.calculate_variable_window_bounds`. My suggestion is to implement this function in cudf.","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps50hy8l","author":{"login":"shwina"},"authorAssociation":"CONTRIBUTOR","body":"Thanks for reporting. I'm currently working on a refactor of our `rolling` Python implementation and I'll see if I can include this there! ","createdAt":"2024-02-20T20:27:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/15086#issuecomment-1955016485","viewerDidAuthor":false}],"createdAt":"2024-02-19T07:50:52Z","id":"I_kwDOBWUGps5_qEQd","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"}],"milestone":null,"number":15086,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[FEA] Implement center for offset based windows","updatedAt":"2024-02-20T20:27:14Z","url":"https://github.com/rapidsai/cudf/issues/15086"}
