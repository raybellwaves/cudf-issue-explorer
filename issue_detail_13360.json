{"assignees":[],"author":{"id":"MDQ6VXNlcjM5NDM3NjE=","is_bot":false,"login":"bdice","name":"Bradley Dice"},"body":"**Is your feature request related to a problem? Please describe.**\r\n\r\nSome features in libcudf like the AST and nested comparators have pretty hefty kernels. The `__grid_constant__` annotation (available in CUDA 11.7 and higher) may help reduce local memory usage in these features. We build with CUDA >=11.8 so this would be supported in our builds.\r\n\r\nhttps://docs.nvidia.com/cuda/cuda-c-programming-guide/#grid-constant\r\n\r\nIn short:\r\n> If the address of a _global_ function parameter is taken, the compiler will ordinarily make a copy of the kernel parameter in thread local memory and use the address of the copy, to partially support C++ semantics, which allow each thread to modify its own local copy of function parameters. Annotating a _global_ function parameter with __grid_constant__ ensures that the compiler will not create a copy of the kernel parameter in thread local memory, but will instead use the generic address of the parameter itself. Avoiding the local copy may result in improved performance.\r\n\r\n@jrhemstad thinks a fair amount of the register/stack usage in AST and comparator code comes from thread local copies of those structs. @bdice agrees this is worth investigating.\r\n\r\n(Some issue text contributed by @jrhemstad.)\r\n\r\n**Describe the solution you'd like**\r\nTry adding `__grid_constant__` to AST kernels and nested comparators to see how the kernels' usage of local memory, registers, etc. changes.","closed":false,"closedAt":null,"comments":[],"createdAt":"2023-05-16T17:43:02Z","id":"I_kwDOBWUGps5mEg_d","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMzIyMjUyNjE3","name":"Performance","description":"Performance related issue","color":"C2E0C6"}],"milestone":null,"number":13360,"projectCards":[],"projectItems":[],"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}},{"content":"EYES","users":{"totalCount":2}}],"state":"OPEN","title":"[FEA] Try using `__grid_constant__` in libcudf.","updatedAt":"2023-06-06T17:34:47Z","url":"https://github.com/rapidsai/cudf/issues/13360"}
