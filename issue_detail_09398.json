{"assignees":[],"author":{"id":"MDQ6VXNlcjgwODQwNjk3","is_bot":false,"login":"esnvidia","name":""},"body":"While creating a synthetic dataset with [cuML Dask make_classification](https://docs.rapids.ai/api/cuml/stable/api.html#cuml.dask.datasets.classification.make_classification) to create into a cuGraph object I get \r\n```\r\nArrowInvalid: Could not convert 250000 with type cupy._core.core.ndarray: did not recognize Python value type when inferring an Arrow data type\r\n```\r\n\r\nwhen converting a Dask Array (output from cuML dask make_classification ) -> Dask DataFrame -> Dask cuDF DataFrame to instantiate a cuGraph DiGraph object. I think 250000 refers to the second index division (0 being the first).\r\n\r\nSee attached sample code to reproduce, which also has other things I tried as well.\r\n\r\nFeature: For a possible future feature to create dask_cudf DataFrames from Dask Arrays directly? Something like `dask_cudf.DataFrame.from_dask_array(dask_array, columns=[] ...)` or similar would be nice.\r\n\r\n**Expected behavior**\r\nCreate a dask cuDF DataFrame and run louvain.\r\n\r\n**Environment details**\r\ndocker container withRapids 21.06 on a DGX\r\n\r\nHere's sample code\r\n[snippet.txt](https://github.com/rapidsai/cudf/files/7304748/snippet.txt)\r\n\r\n","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps439c2w","author":{"login":"beckernick"},"authorAssociation":"MEMBER","body":"Hi @esnvidia , thanks for filing an issue. Is it possible to reduce this to a minimal example? Or does it only reproduce in the context of cuML's distributed NearestNeighbors, concatenating, and other operations","createdAt":"2021-10-08T16:57:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/9398#issuecomment-938855856","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps43-Lzw","author":{"login":"esnvidia"},"authorAssociation":"NONE","body":"Hi @beckernick it's possible to make it work w/o Nearest Neighbors, I just needed a way to make  source-destination pairs, that I'm using for an example. It's pretty minimal. The issue is going from a dask array -> dask_cudf DataFrame. I generate the dask array with cuML because it's how I'm actually doing it and it should ensure that it's cupy aware too.","createdAt":"2021-10-08T18:49:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/9398#issuecomment-939048176","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps45xp3y","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2021-11-15T21:02:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/9398#issuecomment-969317874","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps495XzG","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2022-02-13T22:03:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/9398#issuecomment-1038449862","viewerDidAuthor":false}],"createdAt":"2021-10-07T15:01:30Z","id":"I_kwDOBWUGps48zjvm","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWw1OTk2MjY1NjQ=","name":"question","description":"Further information is requested","color":"D4C5F9"},{"id":"MDU6TGFiZWwxMTg1MjQwODk4","name":"dask","description":"Dask issue","color":"fcc25d"}],"milestone":null,"number":9398,"projectCards":[{"project":{"name":"Bug Squashing"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG][FEA] Convert Dask Array to Dask cuDF DataFrame causes ArrowInvalid Error","updatedAt":"2024-02-23T18:46:16Z","url":"https://github.com/rapidsai/cudf/issues/9398"}
