{"assignees":[],"author":{"id":"MDQ6VXNlcjE5OTQ5MjA3","is_bot":false,"login":"ayushdg","name":"Ayush Dattagupta"},"body":"**Describe the bug**\r\nFor certain datasets, `cudf.read_json(lines=True, engine=\"cudf\")` fails when combining multiple files, while reading them individually works as expected.\r\n\r\n**Steps/Code to reproduce bug**\r\n```\r\ndf = cudf.read_json(files, engine=\"cudf_legacy\", lines=True)\r\n```\r\n\r\n**Expected behavior**\r\nNo error.\r\n\r\n**Environment overview (please complete the following information)**\r\n - Environment location: [Bare-metal, Docker, Cloud(specify cloud provider)]\r\n - Method of cuDF install: [conda, Docker, or from source]\r\n   - 22.10 nightly from oct 05\r\n\r\n**Environment details**\r\nPlease run and paste the output of the `cudf/print_env.sh` script here, to gather any other relevant environment details\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5ri0oD","author":{"login":"GregoryKimball"},"authorAssociation":"CONTRIBUTOR","body":"Thank you @ayushdg for reporting this. Would you please help us create a minimum repro for these files? The issue is probably in the way the files are being concatenated, and the files must have some property that we didn't expect.","createdAt":"2023-11-09T17:51:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/14268#issuecomment-1804290563","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5r6bse","author":{"login":"karthikeyann"},"authorAssociation":"CONTRIBUTOR","body":"@ayushdg what is the failure error?\r\nPlease share the files to reproduce this error.","createdAt":"2023-11-14T15:40:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/14268#issuecomment-1810479902","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5r6_M7","author":{"login":"ayushdg"},"authorAssociation":"MEMBER","body":"Thanks for following up. On further inspection it looks like it was happening because some of the jsonl files were empty which ended up tripping/confusing the parser when reading multiple files simultaneously. \n\nFor the time being we explicitly check for empty files in the curator codebase, but I wonder if there's scope for better error messages here instead of the json parser error at location xyz. ","createdAt":"2023-11-14T16:30:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/14268#issuecomment-1810625339","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5spyDc","author":{"login":"wence-"},"authorAssociation":"CONTRIBUTOR","body":"FWIW, I can't reproduce a failure with a minimal set of files with two non-empty and one empty one.","createdAt":"2023-11-22T14:36:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/14268#issuecomment-1822892252","viewerDidAuthor":false}],"createdAt":"2023-10-10T21:33:33Z","id":"I_kwDOBWUGps5zaaeW","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMDEzOTg3Nzk5","name":"0 - Waiting on Author","description":"Waiting for author to respond to review","color":"ffb88c"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMTg1MjQ0MTQy","name":"cuIO","description":"cuIO issue","color":"fef2c0"}],"milestone":{"number":13,"title":"Nested JSON reader","description":"Data-parallel reader for nested JSON text data","dueOn":null},"number":14268,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] read_json fails when reading multiple files but works with the individual files","updatedAt":"2023-11-22T14:36:48Z","url":"https://github.com/rapidsai/cudf/issues/14268"}
