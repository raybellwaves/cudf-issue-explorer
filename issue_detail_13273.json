{"assignees":[],"author":{"id":"MDQ6VXNlcjExMjY5ODE=","is_bot":false,"login":"wence-","name":"Lawrence Mitchell"},"body":"**Describe the bug**\r\n\r\nIn pandas, it is allowable to construct a dataframe where the same name is used for more than one of the columns (seems unlikely you would _want_ to do this, but OK).\r\n\r\nIn cudf, in contrast, duplicate column names are _not_ allowed. However, this restriction is only checked in a few APIs (`from_pandas` complains, for example, but `DataFrame.__init__` doesn't).\r\n\r\nThis is rather nefarious because operations succeed but silently drop data.\r\n\r\nExample:\r\n```python\r\nimport pandas as pd\r\nimport numpy as np\r\nimport cudf\r\n\r\ndf = pd.DataFrame(np.arange(4).reshape(2, 2), columns=[\"A\", \"A\"])\r\nassert df.sum().sum() == 6 # succeeds\r\ncdf = cudf.DataFrame(np.arange(4).reshape(2, 2), columns=[\"A\", \"A\"]) # succeeds, but throws away first column\r\n\r\nassert cdf.sum().sum() == 6 # fails\r\ncdf2 = cudf.from_pandas(df) # raises ValueError\r\n```\r\n\r\n\r\n**Expected behavior**\r\n\r\nEither\r\n\r\n1. Support this use case (probably a big job)\r\n2. Raise `ValueError` in all cases (easier, minimal sufficient requirement for xdf).","closed":false,"closedAt":null,"comments":[],"createdAt":"2023-05-02T15:23:13Z","id":"I_kwDOBWUGps5k43Tn","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMDEzOTg3MzUy","name":"0 - Backlog","description":"In queue waiting for assignment","color":"d4c5f9"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":null,"number":13273,"projectCards":[],"projectItems":[],"reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"state":"OPEN","title":"[BUG] dataframe construction silently drops data with duplicate column names","updatedAt":"2023-06-07T20:58:23Z","url":"https://github.com/rapidsai/cudf/issues/13273"}
