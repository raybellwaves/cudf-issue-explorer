{"assignees":[],"author":{"id":"MDQ6VXNlcjM5NDM3NjE=","is_bot":false,"login":"bdice","name":"Bradley Dice"},"body":"In PR #9889, @isVoid observed that cudf and pandas handle covariance calculations differently when `N == ddof`. Here is a minimal example showing a few differences in behavior with `ddof`. This is a bug because cudf should give the same results as pandas. The bug affects both `df.cov()` and `df.groupby(...).cov()`. Note that this is _not_ related to the pandas bug 45814 which was also found during #9889 (not directly linked here because it is not related) regarding `ddof` with missing data, because no data is missing here.\r\n\r\n```python\r\nimport pandas as pd\r\nimport cudf\r\n\r\npdf = pd.DataFrame({\"i\": [0, 0], \"a\": [0, 1]})\r\ngdf = cudf.from_pandas(pdf)\r\nprint(\"pandas cov\")\r\nprint(pdf.cov(ddof=2))\r\nprint(\"cudf cov\")\r\nprint(gdf.cov(ddof=2))\r\nprint(\"pandas groupby cov\")\r\nprint(pdf.groupby(\"i\").cov(ddof=2))\r\nprint(\"cudf groupby cov\")\r\nprint(gdf.groupby(\"i\").cov(ddof=2))\r\n```\r\n\r\nResults (warnings not shown):\r\n```python\r\npandas cov                                                                                                                                                                                    \r\n    i    a\r\ni NaN  NaN\r\na NaN  inf\r\n\r\ncudf cov\r\n     i    a\r\ni  0.0  0.0\r\na  0.0  0.5\r\n\r\npandas groupby cov\r\n       a\r\ni       \r\n0 a  inf\r\n\r\ncudf groupby cov\r\n        a\r\ni        \r\n0 a  <NA>\r\n```\r\n\r\nNotice that cudf isn't self-consistent between `df.cov()` and `df.groupby(...).cov()` in its results for `a`.\r\n\r\n_Originally posted by @bdice in https://github.com/rapidsai/cudf/pull/9889#discussion_r807267844_","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps4-JBFY","author":{"login":"isVoid"},"authorAssociation":"CONTRIBUTOR","body":"This was accidentally closed because my comment here: https://github.com/rapidsai/cudf/pull/9889#pullrequestreview-885124236","createdAt":"2022-02-17T04:02:43Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"LAUGH","users":{"totalCount":1}}],"url":"https://github.com/rapidsai/cudf/issues/10303#issuecomment-1042551128","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps4_86uC","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2022-03-19T04:03:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10303#issuecomment-1072933762","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5FDNru","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2022-06-17T04:10:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10303#issuecomment-1158470382","viewerDidAuthor":false}],"createdAt":"2022-02-16T02:15:44Z","id":"I_kwDOBWUGps5D6nfN","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":null,"number":10303,"projectCards":[{"project":{"name":"Bug Squashing"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"state":"OPEN","title":"[BUG] cuDF covariance does not agree with pandas when ddof=N","updatedAt":"2024-02-23T18:42:54Z","url":"https://github.com/rapidsai/cudf/issues/10303"}
