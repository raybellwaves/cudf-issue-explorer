{"assignees":[],"author":{"id":"MDQ6VXNlcjExNjY0MjU5","is_bot":false,"login":"galipremsagar","name":"GALI PREM SAGAR"},"body":"**Describe the bug**\r\nWe seem to be reading in an integer column with nulls as a floating column. This is similar to pandas behavior but since we have support for nullable dtypes in all dtypes, should we even type-cast to float?\r\n\r\n**Steps/Code to reproduce bug**\r\n```python\r\nIn[20]: df = cudf.DataFrame({'a':cudf.Series([1, 2, 3], dtype='uint64')})\r\nIn[21]: df.to_csv('temp.csv')\r\nIn[22]: cudf.read_csv('temp.csv')\r\nOut[22]: \r\n   Unnamed: 0  a\r\n0           0  1\r\n1           1  2\r\n2           2  3\r\nIn[23]: pd.read_csv('temp.csv')\r\nOut[23]: \r\n   Unnamed: 0  a\r\n0           0  1\r\n1           1  2\r\n2           2  3\r\nIn[24]: df = cudf.DataFrame({'a':cudf.Series([1, 2, 3, None], dtype='uint64')})\r\nIn[25]: df.to_csv('temp.csv')\r\nIn[26]: cudf.read_csv('temp.csv')\r\nOut[26]: \r\n   Unnamed: 0     a\r\n0           0   1.0\r\n1           1   2.0\r\n2           2   3.0\r\n3           3  <NA>\r\nIn[27]: pd.read_csv('temp.csv')\r\nOut[27]: \r\n   Unnamed: 0    a\r\n0           0  1.0\r\n1           1  2.0\r\n2           2  3.0\r\n3           3  NaN\r\n```\r\n\r\n**Expected behavior**\r\nExpected behavior is to not type-cast to float and only cast to the inferred dtype.\r\n\r\n**Environment overview (please complete the following information)**\r\n - Environment location: Bare-metal\r\n - Method of cuDF install:  from source\r\n\r\n**Environment details**\r\nPlease run and paste the output of the `cudf/print_env.sh` script here, to gather any other relevant environment details\r\n<details><summary>Click here to see environment details</summary><pre>\r\n     \r\n     **git***\r\n     commit 768b67c37c2e3539f3d80d3c881ff8b1b320e56b (HEAD -> branch-0.16, upstream/branch-0.16)\r\n     Author: GALI PREM SAGAR <sagarprem75@gmail.com>\r\n     Date:   Thu Sep 24 09:18:00 2020 -0500\r\n     \r\n     Implement Fuzz tests for cuIO (#6114)\r\n     \r\n     * add log reporting for failed tests\r\n     \r\n     * add random data generation apis for all dtypes\r\n     \r\n     * make size as mandatory param\r\n     \r\n     * add random dataframe generation api\r\n     \r\n     * add Fuzz tests for parquet reader\r\n     \r\n     * add support for datetime, timedelta and category dtypes datageneration\r\n     \r\n     * add parquet writer tests\r\n     \r\n     * add csv writer and reader tests\r\n     \r\n     * add all dtypes support for random dataframe generation\r\n     \r\n     * add logging for exception\r\n     \r\n     * add all dtypes in CSV and parquet testing\r\n     \r\n     * cleanup\r\n     \r\n     * code cleanup\r\n     \r\n     * typo\r\n     \r\n     * add support for regression run from crash files\r\n     \r\n     * add json reader writer tests\r\n     \r\n     * fix issue related to picking random dtypes\r\n     \r\n     * replace prints with logging\r\n     \r\n     * exclude timedelta dtypes in CSV reader / writer tests\r\n     \r\n     * use seed in generate_input apis\r\n     \r\n     * add max_columns param\r\n     \r\n     * change param file extension to json from xml\r\n     \r\n     * add columns param\r\n     \r\n     * fix issues with regression run\r\n     \r\n     * add Readme for fuzz tests\r\n     \r\n     * add call method to fuzzer\r\n     \r\n     * add readme for fuzz tests\r\n     \r\n     * change main block code\r\n     \r\n     * add url\r\n     \r\n     * fix issue with float dtype data generation\r\n     \r\n     * add tips in readme\r\n     \r\n     * Update CHANGELOG.md\r\n     \r\n     * apply seeds\r\n     \r\n     * change the format of the dtypes_meta for rand_dataframe\r\n     \r\n     * re-organize tests into their respective files\r\n     \r\n     * move common code\r\n     \r\n     * use 3x faster np.radom apis instead of mimesis\r\n     \r\n     * make optimizations in _generate_column and fix lambda scope issues\r\n     \r\n     * remove redundant numpy computation\r\n     \r\n     * moved common code into utils.py\r\n     \r\n     * make max string length generation random\r\n     \r\n     * add todo for list dtype support\r\n     \r\n     * add copyright and use string buffer\r\n     \r\n     * change print to an error\r\n     \r\n     * handle keyboard interrupts and exit\r\n     \r\n     * replace writing to parquet directly from pyarrow\r\n     \r\n     * remove skipping of timedelta types in csv\r\n     \r\n     * give limits to datetime and duration types\r\n     \r\n     * parametrize max_string_length\r\n     \r\n     * move common code into a base class implementation\r\n     \r\n     * push down common logic into IOBase\r\n     \r\n     * use common logic from IOBase\r\n     \r\n     * remove unused variables\r\n     \r\n     * change default max_rows to 100000\r\n     \r\n     * add utility function to translate to pandas nullable dtypes\r\n     \r\n     * rename IOBase to IOFuzz\r\n     \r\n     * copyright\r\n     \r\n     * change default max_rows_size to 100000\r\n     \r\n     * change from saving to file to return buffer\r\n     \r\n     * Update python/cudf/cudf/fuzz_tests/readme.md\r\n     \r\n     Co-authored-by: Christopher Harris <xixonia@gmail.com>\r\n     \r\n     * add comparison of file contents\r\n     \r\n     * handle deafult param for dirs\r\n     \r\n     * remove redundant test code\r\n     \r\n     * change default value for max rows:\r\n     \r\n     Co-authored-by: Christopher Harris <xixonia@gmail.com>\r\n     **git submodules***\r\n     \r\n     ***OS Information***\r\n     DISTRIB_ID=Ubuntu\r\n     DISTRIB_RELEASE=20.04\r\n     DISTRIB_CODENAME=focal\r\n     DISTRIB_DESCRIPTION=\"Ubuntu 20.04.1 LTS\"\r\n     NAME=\"Ubuntu\"\r\n     VERSION=\"20.04.1 LTS (Focal Fossa)\"\r\n     ID=ubuntu\r\n     ID_LIKE=debian\r\n     PRETTY_NAME=\"Ubuntu 20.04.1 LTS\"\r\n     VERSION_ID=\"20.04\"\r\n     HOME_URL=\"https://www.ubuntu.com/\"\r\n     SUPPORT_URL=\"https://help.ubuntu.com/\"\r\n     BUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\r\n     PRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\r\n     VERSION_CODENAME=focal\r\n     UBUNTU_CODENAME=focal\r\n     Linux pgali-HP-Z8-G4-Workstation 5.4.0-48-generic #52-Ubuntu SMP Thu Sep 10 10:58:49 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n     \r\n     ***GPU Information***\r\n     Thu Sep 24 15:26:03 2020\r\n     +-----------------------------------------------------------------------------+\r\n     | NVIDIA-SMI 450.66       Driver Version: 450.66       CUDA Version: 11.0     |\r\n     |-------------------------------+----------------------+----------------------+\r\n     | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n     | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n     |                               |                      |               MIG M. |\r\n     |===============================+======================+======================|\r\n     |   0  Quadro RTX 8000     Off  | 00000000:22:00.0 Off |                  Off |\r\n     | 33%   30C    P8     4W / 260W |    874MiB / 48601MiB |      0%      Default |\r\n     |                               |                      |                  N/A |\r\n     +-------------------------------+----------------------+----------------------+\r\n     |   1  Quadro RTX 8000     Off  | 00000000:2D:00.0  On |                  Off |\r\n     | 33%   35C    P8    20W / 260W |    588MiB / 48592MiB |     18%      Default |\r\n     |                               |                      |                  N/A |\r\n     +-------------------------------+----------------------+----------------------+\r\n     \r\n     +-----------------------------------------------------------------------------+\r\n     | Processes:                                                                  |\r\n     |  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\r\n     |        ID   ID                                                   Usage      |\r\n     |=============================================================================|\r\n     |    0   N/A  N/A       960      G   /usr/lib/xorg/Xorg                  4MiB |\r\n     |    0   N/A  N/A      1820      G   /usr/lib/xorg/Xorg                  4MiB |\r\n     |    0   N/A  N/A      5056      C   .../envs/cudf_dev/bin/python      695MiB |\r\n     |    0   N/A  N/A      6256      C   ...ffice/program/soffice.bin      165MiB |\r\n     |    1   N/A  N/A       960      G   /usr/lib/xorg/Xorg                 39MiB |\r\n     |    1   N/A  N/A      1820      G   /usr/lib/xorg/Xorg                287MiB |\r\n     |    1   N/A  N/A      2020      G   /usr/bin/gnome-shell              200MiB |\r\n     |    1   N/A  N/A      5616      G   /usr/lib/firefox/firefox            3MiB |\r\n     |    1   N/A  N/A      5788      G   ...AAAAAAAAA= --shared-files       44MiB |\r\n     +-----------------------------------------------------------------------------+\r\n     \r\n     ***CPU***\r\n     Architecture:                    x86_64\r\n     CPU op-mode(s):                  32-bit, 64-bit\r\n     Byte Order:                      Little Endian\r\n     Address sizes:                   46 bits physical, 48 bits virtual\r\n     CPU(s):                          12\r\n     On-line CPU(s) list:             0-11\r\n     Thread(s) per core:              2\r\n     Core(s) per socket:              6\r\n     Socket(s):                       1\r\n     NUMA node(s):                    1\r\n     Vendor ID:                       GenuineIntel\r\n     CPU family:                      6\r\n     Model:                           85\r\n     Model name:                      Intel(R) Xeon(R) Gold 6128 CPU @ 3.40GHz\r\n     Stepping:                        4\r\n     CPU MHz:                         1200.141\r\n     CPU max MHz:                     3700.0000\r\n     CPU min MHz:                     1200.0000\r\n     BogoMIPS:                        6800.00\r\n     Virtualization:                  VT-x\r\n     L1d cache:                       192 KiB\r\n     L1i cache:                       192 KiB\r\n     L2 cache:                        6 MiB\r\n     L3 cache:                        19.3 MiB\r\n     NUMA node0 CPU(s):               0-11\r\n     Vulnerability Itlb multihit:     KVM: Vulnerable\r\n     Vulnerability L1tf:              Mitigation; PTE Inversion\r\n     Vulnerability Mds:               Mitigation; Clear CPU buffers; SMT vulnerable\r\n     Vulnerability Meltdown:          Mitigation; PTI\r\n     Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp\r\n     Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization\r\n     Vulnerability Spectre v2:        Mitigation; Full generic retpoline, IBPB conditional, IBRS_FW, STIBP conditional, RSB filling\r\n     Vulnerability Srbds:             Not affected\r\n     Vulnerability Tsx async abort:   Mitigation; Clear CPU buffers; SMT vulnerable\r\n     Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cdp_l3 invpcid_single pti intel_ppin ssbd mba ibrs ibpb stibp tpr_shadow vnmi flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb intel_pt avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts hwp hwp_act_window hwp_epp hwp_pkg_req pku ospke md_clear flush_l1d\r\n     \r\n     ***CMake***\r\n     /home/pgali/anaconda3/envs/cudf_dev/bin/cmake\r\n     cmake version 3.18.2\r\n     \r\n     CMake suite maintained and supported by Kitware (kitware.com/cmake).\r\n     \r\n     ***g++***\r\n     /usr/bin/g++\r\n     g++ (Ubuntu 9.3.0-10ubuntu2) 9.3.0\r\n     Copyright (C) 2019 Free Software Foundation, Inc.\r\n     This is free software; see the source for copying conditions.  There is NO\r\n     warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n     \r\n     \r\n     ***nvcc***\r\n     /usr/local/cuda/bin/nvcc\r\n     nvcc: NVIDIA (R) Cuda compiler driver\r\n     Copyright (c) 2005-2020 NVIDIA Corporation\r\n     Built on Wed_Jul_22_19:09:09_PDT_2020\r\n     Cuda compilation tools, release 11.0, V11.0.221\r\n     Build cuda_11.0_bu.TC445_37.28845127_0\r\n     \r\n     ***Python***\r\n     /home/pgali/anaconda3/envs/cudf_dev/bin/python\r\n     Python 3.7.8\r\n     \r\n     ***Environment Variables***\r\n     PATH                            : /home/pgali/anaconda3/envs/cudf_dev/bin:/home/pgali/anaconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/cuda/bin\r\n     LD_LIBRARY_PATH                 : :/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64\r\n     NUMBAPRO_NVVM                   :\r\n     NUMBAPRO_LIBDEVICE              :\r\n     CONDA_PREFIX                    : /home/pgali/anaconda3/envs/cudf_dev\r\n     PYTHON_PATH                     :\r\n     \r\n     ***conda packages***\r\n     /home/pgali/anaconda3/condabin/conda\r\n     # packages in environment at /home/pgali/anaconda3/envs/cudf_dev:\r\n     #\r\n     # Name                    Version                   Build  Channel\r\n     _libgcc_mutex             0.1                 conda_forge    conda-forge\r\n     _openmp_mutex             4.5                       1_gnu    conda-forge\r\n     abseil-cpp                20200225.2           he1b5a44_2    conda-forge\r\n     alabaster                 0.7.12                     py_0    conda-forge\r\n     appdirs                   1.4.3                      py_1    conda-forge\r\n     argon2-cffi               20.1.0           py37h8f50634_1    conda-forge\r\n     arrow-cpp                 1.0.1           py37hf00d4d6_5_cuda    conda-forge\r\n     arrow-cpp-proc            1.0.1                      cuda    conda-forge\r\n     async_generator           1.10                       py_0    conda-forge\r\n     attrs                     20.2.0             pyh9f0ad1d_0    conda-forge\r\n     aws-c-common              0.4.57               he1b5a44_0    conda-forge\r\n     aws-c-event-stream        0.1.6                h72b8ae1_3    conda-forge\r\n     aws-checksums             0.1.9                h346380f_0    conda-forge\r\n     aws-sdk-cpp               1.7.164              h69f4914_4    conda-forge\r\n     babel                     2.8.0                      py_0    conda-forge\r\n     backcall                  0.2.0              pyh9f0ad1d_0    conda-forge\r\n     backports                 1.0                        py_2    conda-forge\r\n     backports.functools_lru_cache 1.6.1                      py_0    conda-forge\r\n     black                     19.10b0                    py_4    conda-forge\r\n     bleach                    3.2.1              pyh9f0ad1d_0    conda-forge\r\n     bokeh                     2.2.1            py37hc8dfbb8_0    conda-forge\r\n     boost-cpp                 1.74.0               h9359b55_0    conda-forge\r\n     brotli                    1.0.9                he1b5a44_0    conda-forge\r\n     brotlipy                  0.7.0           py37h8f50634_1000    conda-forge\r\n     bzip2                     1.0.8                h516909a_3    conda-forge\r\n     c-ares                    1.16.1               h516909a_3    conda-forge\r\n     ca-certificates           2020.6.20            hecda079_0    conda-forge\r\n     certifi                   2020.6.20        py37hc8dfbb8_0    conda-forge\r\n     cffi                      1.14.3           py37h2b28604_0    conda-forge\r\n     cfgv                      3.2.0                      py_0    conda-forge\r\n     chardet                   3.0.4           py37hc8dfbb8_1007    conda-forge\r\n     clang                     8.0.1                hc9558a2_2    conda-forge\r\n     clang-tools               8.0.1                hc9558a2_2    conda-forge\r\n     clangxx                   8.0.1                         2    conda-forge\r\n     click                     7.1.2              pyh9f0ad1d_0    conda-forge\r\n     cloudpickle               1.6.0                      py_0    conda-forge\r\n     cmake                     3.18.2               h5c55442_0    conda-forge\r\n     cmake_setuptools          0.1.3                      py_0    rapidsai\r\n     commonmark                0.9.1                      py_0    conda-forge\r\n     cryptography              3.1              py37hb09aad4_0    conda-forge\r\n     csv-diff                  0.6                      pypi_0    pypi\r\n     cudatoolkit               11.0.221             h6bb024c_0    nvidia\r\n     cudf                      0.16.0a0+1960.g848b4266fa          pypi_0    pypi\r\n     cudnn                     8.0.0                cuda11.0_0    nvidia\r\n     cupy                      7.8.0            py37h0ce7dbb_0    rapidsai\r\n     cython                    0.29.21          py37h3340039_0    conda-forge\r\n     cytoolz                   0.10.1           py37h516909a_0    conda-forge\r\n     dask                      2.27.0+5.g5fa77484          pypi_0    pypi\r\n     dask-cudf                 0.16.0a0+1956.g0d50234f35.dirty          pypi_0    pypi\r\n     decorator                 4.4.2                      py_0    conda-forge\r\n     defusedxml                0.6.0                      py_0    conda-forge\r\n     dictdiffer                0.8.1                    pypi_0    pypi\r\n     distlib                   0.3.1              pyh9f0ad1d_0    conda-forge\r\n     distributed               2.27.0+1.g8aefbf36          pypi_0    pypi\r\n     dlpack                    0.3                  he1b5a44_1    conda-forge\r\n     docutils                  0.16             py37hc8dfbb8_1    conda-forge\r\n     double-conversion         3.1.5                he1b5a44_2    conda-forge\r\n     editdistance              0.5.3            py37h3340039_1    conda-forge\r\n     entrypoints               0.3             py37hc8dfbb8_1001    conda-forge\r\n     expat                     2.2.9                he1b5a44_2    conda-forge\r\n     fastavro                  1.0.0.post1      py37h8f50634_0    conda-forge\r\n     fastrlock                 0.5              py37h3340039_0    conda-forge\r\n     filelock                  3.0.12             pyh9f0ad1d_0    conda-forge\r\n     flake8                    3.8.3                      py_1    conda-forge\r\n     flatbuffers               1.12.0               he1b5a44_0    conda-forge\r\n     freetype                  2.10.2               he06d7ca_0    conda-forge\r\n     fsspec                    0.8.2                      py_0    conda-forge\r\n     future                    0.18.2           py37hc8dfbb8_1    conda-forge\r\n     gflags                    2.2.2             he1b5a44_1004    conda-forge\r\n     glog                      0.4.0                h49b9bf7_3    conda-forge\r\n     gmp                       6.2.0                he1b5a44_2    conda-forge\r\n     grpc-cpp                  1.30.2               heedbac9_0    conda-forge\r\n     heapdict                  1.0.1                      py_0    conda-forge\r\n     hypothesis                5.28.0                     py_0    conda-forge\r\n     icu                       67.1                 he1b5a44_0    conda-forge\r\n     identify                  1.5.4              pyh9f0ad1d_0    conda-forge\r\n     idna                      2.10               pyh9f0ad1d_0    conda-forge\r\n     imagesize                 1.2.0                      py_0    conda-forge\r\n     importlib-metadata        1.7.0            py37hc8dfbb8_0    conda-forge\r\n     importlib_metadata        1.7.0                         0    conda-forge\r\n     iniconfig                 1.0.1              pyh9f0ad1d_0    conda-forge\r\n     ipykernel                 5.3.4            py37h43977f1_0    conda-forge\r\n     ipython                   7.18.1           py37hc6149b9_0    conda-forge\r\n     ipython_genutils          0.2.0                      py_1    conda-forge\r\n     isort                     5.0.7            py37hc8dfbb8_0    conda-forge\r\n     jedi                      0.17.2           py37hc8dfbb8_0    conda-forge\r\n     jinja2                    2.11.2             pyh9f0ad1d_0    conda-forge\r\n     jpeg                      9d                   h516909a_0    conda-forge\r\n     jsonschema                3.2.0            py37hc8dfbb8_1    conda-forge\r\n     jupyter_client            6.1.7                      py_0    conda-forge\r\n     jupyter_core              4.6.3            py37hc8dfbb8_1    conda-forge\r\n     jupyterlab_pygments       0.1.1              pyh9f0ad1d_0    conda-forge\r\n     krb5                      1.17.1               hfafb76e_3    conda-forge\r\n     lcms2                     2.11                 hbd6801e_0    conda-forge\r\n     ld_impl_linux-64          2.35                 h769bd43_9    conda-forge\r\n     libblas                   3.8.0               17_openblas    conda-forge\r\n     libcblas                  3.8.0               17_openblas    conda-forge\r\n     libcurl                   7.71.1               hcdd3856_6    conda-forge\r\n     libedit                   3.1.20191231         he28a2e2_2    conda-forge\r\n     libev                     4.33                 h516909a_1    conda-forge\r\n     libevent                  2.1.10               hcdb4288_2    conda-forge\r\n     libffi                    3.2.1             he1b5a44_1007    conda-forge\r\n     libgcc-ng                 9.3.0               h24d8f2e_16    conda-forge\r\n     libgfortran-ng            7.5.0               hdf63c60_16    conda-forge\r\n     libgomp                   9.3.0               h24d8f2e_16    conda-forge\r\n     liblapack                 3.8.0               17_openblas    conda-forge\r\n     libllvm10                 10.0.1               he513fc3_3    conda-forge\r\n     libllvm8                  8.0.1                hc9558a2_0    conda-forge\r\n     libnghttp2                1.41.0               h8cfc5f6_2    conda-forge\r\n     libopenblas               0.3.10          pthreads_hb3c22a3_4    conda-forge\r\n     libpng                    1.6.37               hed695b0_2    conda-forge\r\n     libprotobuf               3.12.4               h8b12597_0    conda-forge\r\n     librmm                    0.16.0a200922   cuda11.0_ge3ce8c5_384    rapidsai-nightly\r\n     libsodium                 1.0.18               h516909a_0    conda-forge\r\n     libssh2                   1.9.0                hab1572f_5    conda-forge\r\n     libstdcxx-ng              9.3.0               hdf63c60_16    conda-forge\r\n     libthrift                 0.13.0               hbe8ec66_6    conda-forge\r\n     libtiff                   4.1.0                hc7e4089_6    conda-forge\r\n     libutf8proc               2.5.0                h516909a_2    conda-forge\r\n     libuv                     1.39.0               h516909a_0    conda-forge\r\n     libwebp-base              1.1.0                h516909a_3    conda-forge\r\n     llvmlite                  0.34.0           py37h5202443_1    conda-forge\r\n     locket                    0.2.0                      py_2    conda-forge\r\n     lz4-c                     1.9.2                he1b5a44_3    conda-forge\r\n     markdown                  3.2.2                      py_0    conda-forge\r\n     markupsafe                1.1.1            py37h8f50634_1    conda-forge\r\n     mccabe                    0.6.1                      py_1    conda-forge\r\n     mimesis                   4.0.0              pyh9f0ad1d_0    conda-forge\r\n     mistune                   0.8.4           py37h8f50634_1001    conda-forge\r\n     more-itertools            8.5.0                      py_0    conda-forge\r\n     msgpack-python            1.0.0            py37h99015e2_1    conda-forge\r\n     nbclient                  0.5.0                      py_0    conda-forge\r\n     nbconvert                 6.0.5            py37hc8dfbb8_0    conda-forge\r\n     nbformat                  5.0.7                      py_0    conda-forge\r\n     nbsphinx                  0.7.1              pyh9f0ad1d_0    conda-forge\r\n     nccl                      2.7.8.1              h4962215_0    nvidia\r\n     ncurses                   6.2                  he1b5a44_1    conda-forge\r\n     nest-asyncio              1.4.0                      py_1    conda-forge\r\n     nodeenv                   1.5.0              pyh9f0ad1d_0    conda-forge\r\n     notebook                  6.1.4            py37hc8dfbb8_0    conda-forge\r\n     numba                     0.51.2           py37h9fdb41a_0    conda-forge\r\n     numpy                     1.19.1           py37h7ea13bd_2    conda-forge\r\n     numpydoc                  1.1.0              pyh9f0ad1d_0    conda-forge\r\n     olefile                   0.46                       py_0    conda-forge\r\n     openssl                   1.1.1h               h516909a_0    conda-forge\r\n     packaging                 20.4               pyh9f0ad1d_0    conda-forge\r\n     pandas                    1.1.2            py37h3340039_0    conda-forge\r\n     pandoc                    1.19.2                        0    conda-forge\r\n     pandocfilters             1.4.2                      py_1    conda-forge\r\n     parquet-cpp               1.5.1                         2    conda-forge\r\n     parso                     0.7.1              pyh9f0ad1d_0    conda-forge\r\n     partd                     1.1.0                      py_0    conda-forge\r\n     pathspec                  0.8.0              pyh9f0ad1d_0    conda-forge\r\n     pexpect                   4.8.0            py37hc8dfbb8_1    conda-forge\r\n     pickleshare               0.7.5           py37hc8dfbb8_1001    conda-forge\r\n     pillow                    7.2.0            py37h718be6c_1    conda-forge\r\n     pip                       20.2.3                     py_0    conda-forge\r\n     pluggy                    0.13.1           py37hc8dfbb8_2    conda-forge\r\n     pre-commit                2.7.1            py37hc8dfbb8_0    conda-forge\r\n     pre_commit                2.7.1                         0    conda-forge\r\n     prometheus_client         0.8.0              pyh9f0ad1d_0    conda-forge\r\n     prompt-toolkit            3.0.7                      py_0    conda-forge\r\n     psutil                    5.7.2            py37h8f50634_0    conda-forge\r\n     ptyprocess                0.6.0                   py_1001    conda-forge\r\n     py                        1.9.0              pyh9f0ad1d_0    conda-forge\r\n     pyarrow                   1.0.1           py37h72578d1_5_cuda    conda-forge\r\n     pycodestyle               2.6.0              pyh9f0ad1d_0    conda-forge\r\n     pycparser                 2.20               pyh9f0ad1d_2    conda-forge\r\n     pyflakes                  2.2.0              pyh9f0ad1d_0    conda-forge\r\n     pygments                  2.7.1                      py_0    conda-forge\r\n     pyopenssl                 19.1.0                     py_1    conda-forge\r\n     pyparsing                 2.4.7              pyh9f0ad1d_0    conda-forge\r\n     pyrsistent                0.17.3           py37h8f50634_0    conda-forge\r\n     pysocks                   1.7.1            py37hc8dfbb8_1    conda-forge\r\n     pytest                    6.0.2            py37hc8dfbb8_0    conda-forge\r\n     python                    3.7.8           h6f2ec95_1_cpython    conda-forge\r\n     python-dateutil           2.8.1                      py_0    conda-forge\r\n     python_abi                3.7                     1_cp37m    conda-forge\r\n     pytz                      2020.1             pyh9f0ad1d_0    conda-forge\r\n     pyyaml                    5.3.1            py37h8f50634_0    conda-forge\r\n     pyzmq                     19.0.2           py37hac76be4_0    conda-forge\r\n     rapidjson                 1.1.0             he1b5a44_1002    conda-forge\r\n     re2                       2020.08.01           he1b5a44_1    conda-forge\r\n     readline                  8.0                  he28a2e2_2    conda-forge\r\n     recommonmark              0.6.0                      py_0    conda-forge\r\n     regex                     2020.7.14        py37h8f50634_0    conda-forge\r\n     requests                  2.24.0             pyh9f0ad1d_0    conda-forge\r\n     rhash                     1.3.6             h14c3975_1001    conda-forge\r\n     rmm                       0.16.0a200922   cuda_11.0_py37_ge3ce8c5_384    rapidsai-nightly\r\n     send2trash                1.5.0                      py_0    conda-forge\r\n     setuptools                49.6.0           py37hc8dfbb8_1    conda-forge\r\n     six                       1.15.0             pyh9f0ad1d_0    conda-forge\r\n     snappy                    1.1.8                he1b5a44_3    conda-forge\r\n     snowballstemmer           2.0.0                      py_0    conda-forge\r\n     sortedcontainers          2.2.2              pyh9f0ad1d_0    conda-forge\r\n     spdlog                    1.7.0                hc9558a2_2    conda-forge\r\n     sphinx                    3.2.1                      py_0    conda-forge\r\n     sphinx-copybutton         0.3.0              pyh9f0ad1d_0    conda-forge\r\n     sphinx-markdown-tables    0.0.14             pyh9f0ad1d_1    conda-forge\r\n     sphinx_rtd_theme          0.5.0              pyh9f0ad1d_0    conda-forge\r\n     sphinxcontrib-applehelp   1.0.2                      py_0    conda-forge\r\n     sphinxcontrib-devhelp     1.0.2                      py_0    conda-forge\r\n     sphinxcontrib-htmlhelp    1.0.3                      py_0    conda-forge\r\n     sphinxcontrib-jsmath      1.0.1                      py_0    conda-forge\r\n     sphinxcontrib-qthelp      1.0.3                      py_0    conda-forge\r\n     sphinxcontrib-serializinghtml 1.1.4                      py_0    conda-forge\r\n     sphinxcontrib-websupport  1.2.4              pyh9f0ad1d_0    conda-forge\r\n     sqlite                    3.33.0               h4cf870e_0    conda-forge\r\n     streamz                   0.5.6                    pypi_0    pypi\r\n     tblib                     1.6.0                      py_0    conda-forge\r\n     terminado                 0.9.1            py37hc8dfbb8_0    conda-forge\r\n     testpath                  0.4.4                      py_0    conda-forge\r\n     thrift-compiler           0.13.0               hbe8ec66_6    conda-forge\r\n     thrift-cpp                0.13.0                        6    conda-forge\r\n     tk                        8.6.10               hed695b0_0    conda-forge\r\n     toml                      0.10.1             pyh9f0ad1d_0    conda-forge\r\n     toolz                     0.10.0                     py_0    conda-forge\r\n     tornado                   6.0.4            py37h8f50634_1    conda-forge\r\n     traitlets                 5.0.4                      py_0    conda-forge\r\n     typed-ast                 1.4.1            py37h516909a_0    conda-forge\r\n     typing_extensions         3.7.4.2                    py_0    conda-forge\r\n     urllib3                   1.25.10                    py_0    conda-forge\r\n     virtualenv                20.0.20          py37hc8dfbb8_1    conda-forge\r\n     wcwidth                   0.2.5              pyh9f0ad1d_1    conda-forge\r\n     webencodings              0.5.1                      py_1    conda-forge\r\n     wheel                     0.35.1             pyh9f0ad1d_0    conda-forge\r\n     xz                        5.2.5                h516909a_1    conda-forge\r\n     yaml                      0.2.5                h516909a_0    conda-forge\r\n     zeromq                    4.3.2                he1b5a44_3    conda-forge\r\n     zict                      2.0.0                      py_0    conda-forge\r\n     zipp                      3.1.0                      py_0    conda-forge\r\n     zlib                      1.2.11            h516909a_1009    conda-forge\r\n     zstd                      1.4.5                h6597ccf_2    conda-forge\r\n     \r\n</pre></details>\r\n\r\n**Additional context**\r\nSurfaced while running fuzz tests: #6001 \r\n","closed":false,"closedAt":null,"comments":[{"id":"MDEyOklzc3VlQ29tbWVudDY5ODU3NjM3OQ==","author":{"login":"karthikeyann"},"authorAssociation":"CONTRIBUTOR","body":"This is an issue in pandas as well. Our code is conformant with pandas behavior. \r\nhttps://github.com/rapidsai/cudf/blob/60d25ea04bf018905836310a18133806f780cb22/cpp/src/io/csv/reader_impl.cu#L583-L587\r\n\r\n```python\r\nIn [18]: pdf = pd.DataFrame({'a':pd.Series([1, 2, 3, None], dtype='Int64')})\r\n\r\nIn [19]: pdf.dtypes\r\nOut[19]: \r\na    Int64\r\ndtype: object\r\n\r\nIn [20]: pdf.to_csv('temp.csv')\r\n\r\nIn [21]: cat temp.csv\r\n,a\r\n0,1\r\n1,2\r\n2,3\r\n3,\r\n\r\nIn [22]: pd.read_csv('temp.csv').dtypes\r\nOut[22]: \r\nUnnamed: 0      int64\r\na             float64\r\ndtype: object\r\n```","createdAt":"2020-09-24T20:38:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/6313#issuecomment-698576379","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY5ODU3Nzk0MA==","author":{"login":"galipremsagar"},"authorAssociation":"CONTRIBUTOR","body":"I guess the question is with nullable dtypes support introduced in pandas aswell do we still want to mimic pandas behavior?","createdAt":"2020-09-24T20:42:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/6313#issuecomment-698577940","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDcwMDE3ODEwOQ==","author":{"login":"kkraus14"},"authorAssociation":"COLLABORATOR","body":"> I guess the question is with nullable dtypes support introduced in pandas aswell do we still want to mimic pandas behavior?\r\n\r\nAgreed. This sounds like a bug in Pandas at this point and we shouldn't replicate the behavior. @galipremsagar can you open an issue on Pandas for this?","createdAt":"2020-09-28T17:33:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/rapidsai/cudf/issues/6313#issuecomment-700178109","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDcwMDIwMjM5NQ==","author":{"login":"galipremsagar"},"authorAssociation":"CONTRIBUTOR","body":"\r\n> Agreed. This sounds like a bug in Pandas at this point and we shouldn't replicate the behavior. @galipremsagar can you open an issue on Pandas for this?\r\n\r\nLinking for reference: https://github.com/pandas-dev/pandas/issues/36712","createdAt":"2020-09-28T18:21:14Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/6313#issuecomment-700202395","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDcwNjI5NTM4Mg==","author":{"login":"vuule"},"authorAssociation":"CONTRIBUTOR","body":"From the Pandas issue: Pandas will not change this behavior until they start using nullable types by default.\r\nWe can still go ahead with the change.","createdAt":"2020-10-09T17:01:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/rapidsai/cudf/issues/6313#issuecomment-706295382","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4MDEyMzQ0OA==","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been marked rotten due to no recent activity in the past 90d. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2021-02-16T21:17:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/6313#issuecomment-780123448","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5LHVNP","author":{"login":"vuule"},"authorAssociation":"CONTRIBUTOR","body":"Looks like we didn't go ahead with the change :D\r\nFWIW, Pandas still does not default to nullable types, and there's a PR to add an option to use nullable types in `read_csv` https://github.com/pandas-dev/pandas/pull/48776.","createdAt":"2022-09-28T00:12:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/6313#issuecomment-1260213071","viewerDidAuthor":false}],"createdAt":"2020-09-24T20:27:29Z","id":"MDU6SXNzdWU3MDg0NTMwODc=","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMTg1MjQ0MTQy","name":"cuIO","description":"cuIO issue","color":"fef2c0"}],"milestone":{"number":12,"title":"CSV continuous improvement","description":"","dueOn":null},"number":6313,"projectCards":[{"project":{"name":"Bug Squashing"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] `cudf.read_csv` should not cast to floating types if there are null entries in csv","updatedAt":"2023-04-06T05:28:42Z","url":"https://github.com/rapidsai/cudf/issues/6313"}
