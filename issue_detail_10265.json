{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMjA3MDY=","is_bot":false,"login":"wbo4958","name":"Bobby Wang"},"body":"This is part of FEA of https://github.com/NVIDIA/spark-rapids/issues/9\r\nWe have a JSON file\r\n\r\n``` json\r\n{\"name\": // name\r\n \"Reynold Xin\"}\r\n```\r\n\r\nSpark can parse it when enabling `allowComments` and `multiLine`\r\n\r\nor \r\n\r\n``` json\r\n{'name': /* hello */ 'Reynold Xin'}\r\n```\r\n\r\nSpark can parse it when enabling `allowComments` \r\n\r\nWe expect there is a configure `allowComments` to control this behavior. ","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps4_h4UZ","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2022-03-12T09:03:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10265#issuecomment-1065846041","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5DPiuA","author":{"login":"revans2"},"authorAssociation":"CONTRIBUTOR","body":"This is off by default in Spark so it is nice to be able to support this, but it is not a blocker.","createdAt":"2022-05-16T21:19:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10265#issuecomment-1128147840","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5K8_Kn","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2022-09-26T05:30:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10265#issuecomment-1257501351","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5Phs1r","author":{"login":"GregoryKimball"},"authorAssociation":"CONTRIBUTOR","body":"Do the comments only occur in between field names, values, and symbols `: [ {`? If so then then adding a comment state might be easier. \r\n\r\nDoes ` //` comment always end in a `\\n` newline? Can be sure that any `/` occurring outside a quoted region begins a comment? Single-line comments might be possible, but it would bring some performance penalty from increasing the size of the state machine.\r\n\r\nDoes a block comment ever contain `*` characters? If so we would need to add a lookahead for block comments and this would be challenging.","createdAt":"2022-12-01T19:17:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10265#issuecomment-1334234475","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5Pm8BD","author":{"login":"revans2"},"authorAssociation":"CONTRIBUTOR","body":"To be clear this is not a super high priority for us.  We have had no one request this yet, but it is a part of Spark. This would be a feature that we could turn on or turn off.\r\n\r\nThis corresponds to a Jackson JSON parser feature, which is the JSON parser that Spark uses and just exposes some configs for.\r\n\r\nhttps://github.com/FasterXML/jackson-core/blob/0d5c70ff02681b4305f0d4932915e7f025e54e12/src/main/java/com/fasterxml/jackson/core/json/JsonReadFeature.java#L16-L28\r\n\r\nSome of the tests for it are at\r\n\r\nhttps://github.com/FasterXML/jackson-core/blob/390472bbdf4722fe058f48bb0eff5865c8d20f73/src/test/java/com/fasterxml/jackson/core/read/CommentParsingTest.java\r\n\r\n> Do the comments only occur in between field names, values, and symbols : [ {? If so then then adding a comment state might be easier.\r\n\r\nYes, that appears to be correct.  \r\n```\r\n{ \"C\": 5/*5*/6 } \r\n```\r\nresults in an error.\r\n\r\nComment parsing within a quoted string is skipped.\r\n```\r\n{\"B\":\"2\"}\r\n{\"B\":\"2//test\"}\r\n{\"B\":\"2/*test\"}\r\n{\"B\":\"2/*test*/\"}\r\n```\r\n\r\nresults in\r\n\r\n```\r\n+---------+\r\n|B        |\r\n+---------+\r\n|2        |\r\n|2//test  |\r\n|2/*test  |\r\n|2/*test*/|\r\n+---------+\r\n```\r\n\r\n> Does // comment always end in a \\n newline? \r\n\r\nThere are some bugs with this in Spark. For now I would say yes new line \\n or the end of the buffer/file. We can standardize on that. The reality is a little more complicated, but it is for features that I don't think we would support, or need to be bug for bug compatible with Spark for.\r\n\r\n> Can be sure that any / occurring outside a quoted region begins a comment?\r\n\r\nFrom reading the Jackson parser code it appears to be doing exactly that. If it sees a '/' when it is looking to skip white space, a colon, or the end, then it goes into comment skipping mode. If it sees a / by itself that is an error or something after the / that is not another / or a * it is an error.\r\n\r\nhttps://github.com/FasterXML/jackson-core/blob/390472bbdf4722fe058f48bb0eff5865c8d20f73/src/main/java/com/fasterxml/jackson/core/json/UTF8StreamJsonParser.java#L3265-L3282\r\n\r\n> Single-line comments might be possible, but it would bring some performance penalty from increasing the size of the state machine.\r\n\r\nI am not sure what you mean by single line comments?  Do you mean something like\r\n```\r\n{\"A\": 100}\r\n// This is a single line comment\r\n{\"B\": 200}\r\n       /* so is this... */\r\n```\r\n\r\n```\r\n+----+----+\r\n|A   |B   |\r\n+----+----+\r\n|100 |null|\r\n|null|200 |\r\n+----+----+\r\n```\r\n\r\n> Does a block comment ever contain * characters? If so we would need to add a lookahead for block comments and this would be challenging.\r\n\r\nYes\r\n\r\n```\r\n{\"A\": 100 /*****************************************/, \"B\": 200}\r\n```\r\n\r\n","createdAt":"2022-12-02T17:56:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10265#issuecomment-1335607363","viewerDidAuthor":false}],"createdAt":"2022-02-10T08:58:50Z","id":"I_kwDOBWUGps5DVVf2","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxMDEzOTg3MzUy","name":"0 - Backlog","description":"In queue waiting for assignment","color":"d4c5f9"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMTg1MjQ0MTQy","name":"cuIO","description":"cuIO issue","color":"fef2c0"},{"id":"MDU6TGFiZWwxNDA1MTQ2OTc1","name":"Spark","description":"Functionality that helps Spark RAPIDS","color":"7400ff"}],"milestone":{"number":13,"title":"Nested JSON reader","description":"Data-parallel reader for nested JSON text data","dueOn":null},"number":10265,"projectCards":[{"project":{"name":"Feature Planning"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[FEA] JSON reader: ignores Java/C++ style comment","updatedAt":"2023-04-02T22:39:59Z","url":"https://github.com/rapidsai/cudf/issues/10265"}
