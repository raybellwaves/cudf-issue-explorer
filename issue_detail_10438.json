{"assignees":[],"author":{"id":"MDQ6VXNlcjEyNzE2OTc5","is_bot":false,"login":"PointKernel","name":"Yunsong Wang"},"body":"**Describe the bug**\r\nThe statistics calculation is not working properly when dealing with int96 timestamp types. Adding statistics checks in `test_parquet_writer_int96_timestamps` will cause pytest failures.\r\n\r\n**Steps/Code to reproduce bug**\r\nAt the end of `test_parquet_writer_int96_timestamps`, adding the following code:\r\n```python\r\n    # Read back from pyarrow\r\n    pq_file = pq.ParquetFile(gdf_fname)\r\n    # verify each row group's statistics\r\n    for rg in range(0, pq_file.num_row_groups):\r\n        pd_slice = pq_file.read_row_group(rg).to_pandas()\r\n\r\n        # statistics are per-column. So need to verify independently\r\n        for i, col in enumerate(pd_slice):\r\n            stats = pq_file.metadata.row_group(rg).column(i).statistics\r\n\r\n            actual_min = cudf.Series(pd_slice[col].explode().explode()).min()\r\n            stats_min = stats.min\r\n            assert normalized_equals(actual_min, stats_min)\r\n\r\n            actual_max = cudf.Series(pd_slice[col].explode().explode()).max()\r\n            stats_max = stats.max\r\n            assert normalized_equals(actual_max, stats_max)\r\n```\r\nThe statistics test will fail.\r\n\r\n**Expected behavior**\r\nThe test should pass.\r\n\r\n**Additional context**\r\nNot sure if the issue is in libcudf or in the python layer. Adding cpp unit tests for parquet statistics can help track down the issue.","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5BiKx2","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2022-04-14T18:03:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10438#issuecomment-1099476086","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5Gi-wz","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2022-07-13T19:02:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10438#issuecomment-1183575091","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5Gi-7y","author":{"login":"PointKernel"},"authorAssociation":"MEMBER","body":"still relevant","createdAt":"2022-07-13T19:03:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10438#issuecomment-1183575794","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5MATol","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2022-10-11T19:06:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10438#issuecomment-1275148837","viewerDidAuthor":false}],"createdAt":"2022-03-15T17:44:55Z","id":"I_kwDOBWUGps5FvKW7","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"},{"id":"MDU6TGFiZWwxMTg1MjQ0MTQy","name":"cuIO","description":"cuIO issue","color":"fef2c0"}],"milestone":{"number":22,"title":"Parquet continuous improvement","description":"","dueOn":null},"number":10438,"projectCards":[{"project":{"name":"Feature Planning"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] Incorrect statistics for int96 timestamps in parquet","updatedAt":"2024-02-16T23:17:47Z","url":"https://github.com/rapidsai/cudf/issues/10438"}
