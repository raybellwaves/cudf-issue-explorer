{"assignees":[{"id":"MDQ6VXNlcjEyNzE2OTc5","login":"PointKernel","name":"Yunsong Wang"}],"author":{"id":"MDQ6VXNlcjQ1Nzk1OTkx","is_bot":false,"login":"davidwendt","name":"David Wendt"},"body":"The [`device_atomics`](https://github.com/rapidsai/cudf/blob/branch-23.08/cpp/include/cudf/detail/utilities/device_atomics.cuh) implementation in libcudf are failing memchecks when used on types smaller than 4 bytes.\r\n\r\nhttps://github.com/rapidsai/cudf/blob/c929a84719baf169d05e4d0ee87a0df6e77f5b45/cpp/include/cudf/detail/utilities/device_atomics.cuh#L65-L69\r\n\r\nThis was found while investigating some memcheck errors that occurred on `cudf::reduce` where the aggregation return type is `bool` (1 byte) and an `atomicOr` was used to produce the output. Reference: https://github.com/rapidsai/cudf/pull/13574\r\n\r\nThe solution is to use the libcudaxx `cuda::atomic` and `cuda::atomic_ref` in place of these implementations and potentially remove the `device_atomics.cuh` altogether. ","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5hCJul","author":{"login":"PointKernel"},"authorAssociation":"MEMBER","body":"Depends on https://github.com/NVIDIA/cccl/issues/1024","createdAt":"2023-07-10T01:54:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/13575#issuecomment-1627954085","viewerDidAuthor":false}],"createdAt":"2023-06-14T17:28:56Z","id":"I_kwDOBWUGps5ovyiu","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMDEzOTg3NDE3","name":"1 - On Deck","description":"To be worked on next","color":"bfd4f2"},{"id":"MDU6TGFiZWwxMTM5NzQwNjY2","name":"libcudf","description":"Affects libcudf (C++/CUDA) code.","color":"c5def5"}],"milestone":null,"number":13575,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] The libcudf device atomic operations cause memcheck errors on types smaller than 4 bytes","updatedAt":"2023-07-22T20:14:53Z","url":"https://github.com/rapidsai/cudf/issues/13575"}
