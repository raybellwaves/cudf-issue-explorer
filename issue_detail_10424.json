{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNTIxMDA4","is_bot":false,"login":"isVoid","name":"Michael Wang"},"body":"**Is your feature request related to a problem? Please describe.**\r\nToday computing correlation for a dataframe with missing values is not possible, but pandas can do it:\r\n```python\r\nIn [10]: gdf = cudf.DataFrame({\"a\": [1, None, 1, 1, None, 2, 2], \"b\": range(7)})\r\nIn [11]: gdf.corr()\r\n...\r\nValueError: Column must have no nulls.\r\n\r\nIn [14]: pdf = pd.DataFrame({\"a\": [1, None, 1, 1, None, 2, 2], \"b\": range(7)})\r\nIn [15]: pdf.corr()\r\nOut[15]: \r\n          a         b\r\na  1.000000  0.879427\r\nb  0.879427  1.000000\r\n```\r\n\r\n**Describe the solution you'd like**\r\nWe should examine the techniques that pandas used here. In groupby cov/corr's case, we found that pandas uses pairwise deletion on missing values that may result in a non-PSD matrix. There's a test case to make sure cuDF matches with pandas in these situations. Here we should do the same.\r\n\r\n**Describe alternatives you've considered**\r\nThere has been [discussions](https://github.com/rapidsai/cudf/pull/9889#discussion_r808439168) about merging groupby correlation/covariance with regular corr/cov so that they share the same algorithm backbone. But I don't think we need to achieve this in one big step. Extending existing function to support more inputs is a good start.\r\n","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps4_5ZXL","author":{"login":"dominicshanshan"},"authorAssociation":"CONTRIBUTOR","body":"I am going to work on this","createdAt":"2022-03-18T04:04:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10424#issuecomment-1072010699","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5BnPJq","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2022-04-17T05:04:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10424#issuecomment-1100804714","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5BqOBX","author":{"login":"isVoid"},"authorAssociation":"CONTRIBUTOR","body":"This is still relevant.","createdAt":"2022-04-18T17:25:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10424#issuecomment-1101586519","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5DX4ZI","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2022-05-18T18:03:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10424#issuecomment-1130333768","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5D94MO","author":{"login":"dominicshanshan"},"authorAssociation":"CONTRIBUTOR","body":"still working on the code ","createdAt":"2022-05-28T16:39:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10424#issuecomment-1140294414","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5FmIqA","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-30d` due to no recent activity in the past 30 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed. This issue will be labeled `inactive-90d` if there is no activity in the next 60 days.","createdAt":"2022-06-27T17:07:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10424#issuecomment-1167624832","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5GutNZ","author":{"login":"dominicshanshan"},"authorAssociation":"CONTRIBUTOR","body":"studying pandas code","createdAt":"2022-07-18T00:47:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10424#issuecomment-1186648921","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5MSWeG","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2022-10-16T02:59:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10424#issuecomment-1279879046","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5Ur2vD","author":{"login":"mattf"},"authorAssociation":"NONE","body":"this is still an issue in 23.02\r\n\r\n```\r\n>>> import cudf, pandas, numpy\r\n>>> cudf.__version__\r\n'23.02.00a+310.g58e0fde346'\r\n>>> pandas.__version__\r\n'1.5.3'\r\n>>> df = cudf.DataFrame({'a': [1, 2, numpy.NaN, 4], 'b': [4, numpy.NaN, 2, 1]})\r\n>>> df.corr()\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/opt/conda/envs/rapids/lib/python3.8/site-packages/cudf/core/dataframe.py\", line 6506, in corr\r\n    values = self.values\r\n  File \"/opt/conda/envs/rapids/lib/python3.8/site-packages/cudf/core/frame.py\", line 433, in values\r\n    return self.to_cupy()\r\n  File \"/opt/conda/envs/rapids/lib/python3.8/contextlib.py\", line 75, in inner\r\n    return func(*args, **kwds)\r\n  File \"/opt/conda/envs/rapids/lib/python3.8/site-packages/cudf/core/frame.py\", line 533, in to_cupy\r\n    return self._to_array(\r\n  File \"/opt/conda/envs/rapids/lib/python3.8/site-packages/cudf/core/frame.py\", line 498, in _to_array\r\n    matrix[:, i] = get_column_values_na(col)\r\n  File \"/opt/conda/envs/rapids/lib/python3.8/site-packages/cudf/core/frame.py\", line 477, in get_column_values_na\r\n    return get_column_values(col)\r\n  File \"/opt/conda/envs/rapids/lib/python3.8/site-packages/cudf/core/frame.py\", line 536, in <lambda>\r\n    else (lambda col: col.values),\r\n  File \"/opt/conda/envs/rapids/lib/python3.8/site-packages/cudf/core/column/column.py\", line 230, in values\r\n    raise ValueError(\"Column must have no nulls.\")\r\nValueError: Column must have no nulls.\r\n>>> df.to_pandas().corr()\r\n     a    b\r\na  1.0 -1.0\r\nb -1.0  1.0\r\n```","createdAt":"2023-02-07T13:32:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/10424#issuecomment-1420782531","viewerDidAuthor":false}],"createdAt":"2022-03-12T01:04:17Z","id":"I_kwDOBWUGps5FkNoG","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":null,"number":10424,"projectCards":[{"project":{"name":"Feature Planning"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[FEA] Support Correlation with Nullable DataFrames","updatedAt":"2023-04-03T02:14:41Z","url":"https://github.com/rapidsai/cudf/issues/10424"}
