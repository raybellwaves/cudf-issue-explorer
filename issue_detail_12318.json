{"assignees":[],"author":{"id":"MDQ6VXNlcjUzNzk2MDk5","is_bot":false,"login":"brandon-b-miller","name":""},"body":"cuDF supports a [query](https://docs.rapids.ai/api/cudf/nightly/api_docs/api/cudf.DataFrame.query.html) function for evaluating expressions against dataframes. Thus far it has worked by using the `ast` _python_ package to build a python function that gets wrapped in a numba kernel and launched not unlike a UDF. Pandas seems to work by leveraging its own [eval function however](https://github.com/pandas-dev/pandas/blob/v1.5.2/pandas/core/frame.py#L4377-L4378), which I don't think we had at the time `query` was developed. We should investigate if we can make `cudf.DataFrame.query` work similarly. This would have a bunch of benefits including most likely faster performance, no need for runtime compilation or caching, I'm guessing code reduction, and anything new that we get in our internal ast framework that backs `eval`. \r\n\r\ncc @vyasr ","closed":false,"closedAt":null,"comments":[{"id":"IC_kwDOBWUGps5P3ckR","author":{"login":"vyasr"},"authorAssociation":"CONTRIBUTOR","body":"I would support this. The catch is that `eval` [has certain limitations](https://github.com/rapidsai/cudf/blob/branch-23.02/python/cudf/cudf/core/dataframe.py#L6989) that we may either need to relax or work around to maintain equivalent support. In particular, my two concerns are 1) the lack of automatic casting e.g. when comparing float to int, and 2) the lack of support for string/datetime types (I don't recall exactly what `query` supports right now, especially because I don't know how much all the work on string UDFs has or could be easily translated to `query`).","createdAt":"2022-12-06T20:00:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/12318#issuecomment-1339934993","viewerDidAuthor":false}],"createdAt":"2022-12-06T16:42:33Z","id":"I_kwDOBWUGps5YMKZB","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NjE=","name":"feature request","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":null,"number":12318,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[FEA] `DataFrame.query` should be updated to use `eval` as a backend","updatedAt":"2022-12-06T20:00:02Z","url":"https://github.com/rapidsai/cudf/issues/12318"}
