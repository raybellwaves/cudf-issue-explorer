{"assignees":[],"author":{"id":"MDQ6VXNlcjUzNzk2MDk5","is_bot":false,"login":"brandon-b-miller","name":""},"body":"**Describe the bug**\r\nCount aggregations on rolling windows do not match Pandas behavior when using pandas 1.0+. This is due to changes to handling of NaNs and the conditions under which a non-NaN value is allowed to be produced for a particular data window. More discussion in https://github.com/rapidsai/cudf/pull/4546\r\n\r\n\r\n**Steps/Code to reproduce bug**\r\n```\r\n>>> cudf.Series.from_pandas(pd.Series([1,1,1,None])).rolling(2, min_periods=2, center=True).count()\r\n0    null\r\n1       2\r\n2       2\r\n3    null\r\ndtype: int32\r\n\r\n>>> pd.__version__\r\n'1.0.3'\r\n>>> pd.Series([1,1,1,None]).rolling(2, min_periods=2, center=True).count()\r\n0    NaN\r\n1    2.0\r\n2    2.0\r\n3    1.0\r\ndtype: float64\r\n```\r\n\r\n**Expected behavior**\r\nEither matching behavior or an understanding of why we differ. \r\n\r\n\r\n**Environment overview (please complete the following information)**\r\n - Environment location: Bare-metal\r\n - Method of cuDF install: Source\r\n   - If method of install is [Docker], provide `docker pull` & `docker run` commands used\r\n\r\n**Environment details**\r\ncuDF 0.15\r\n\r\n**Additional context**\r\nhttps://github.com/pandas-dev/pandas/pull/30923\r\nhttps://github.com/pandas-dev/pandas/issues/34466\r\n\r\n","closed":false,"closedAt":null,"comments":[{"id":"MDEyOklzc3VlQ29tbWVudDY0OTg1MjQyNg==","author":{"login":"jrhemstad"},"authorAssociation":"CONTRIBUTOR","body":"So the issue is that cuDF produces `null` for the last value whereas Pandas 1.0 produces `1`? \r\n\r\n","createdAt":"2020-06-25T22:37:59Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/5580#issuecomment-649852426","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY1MDE4NTMxNA==","author":{"login":"brandon-b-miller"},"authorAssociation":"CONTRIBUTOR","body":"Yes, that's more or less the problem.","createdAt":"2020-06-26T13:40:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/5580#issuecomment-650185314","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc5ODk2MjM2MA==","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2021-03-14T19:12:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/5580#issuecomment-798962360","viewerDidAuthor":false}],"createdAt":"2020-06-25T20:40:34Z","id":"MDU6SXNzdWU2NDU4Mzc3MTk=","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":null,"number":5580,"projectCards":[{"project":{"name":"Bug Squashing"},"column":{"name":"Needs prioritizing"}}],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] Rolling count aggregations produce different results than Pandas 1.0+","updatedAt":"2024-05-16T05:12:39Z","url":"https://github.com/rapidsai/cudf/issues/5580"}
