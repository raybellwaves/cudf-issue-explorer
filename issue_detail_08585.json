{"assignees":[{"id":"MDQ6VXNlcjExMjY5ODE=","login":"wence-","name":"Lawrence Mitchell"}],"author":{"id":"MDQ6VXNlcjQyNTI2MjE=","is_bot":false,"login":"pbruneau","name":"Pierrick Bruneau"},"body":"**Describe the bug**\r\ncuDF DataFrames indexed by a Timestamp range can be accessed using `.loc[]` without any problem. However, if the cuDF DataFrame is indexed with a MultiIndex with timestamps as the first key, `.loc[]` fails, when doing so causes no issue with pandas.\r\n\r\n**Steps/Code to reproduce bug**\r\nThe [following gist](https://gist.github.com/pbruneau/689242cf5c79ce9185aa7fa3bb1f2e89) holds a self-contained example. The last line of the code fails with error: `TypeError: 'Timestamp' object is not iterable`\r\n\r\n**Expected behavior**\r\nI would expect the pandas and cuDF snippets to behave similarly. \r\n\r\n**Environment overview (please complete the following information)**\r\n - Environment location: Docker\r\n - Method of cuDF install: Docker\r\n   - docker pull rapidsai/rapidsai:0.18-cuda10.1-runtime-ubuntu18.04-py3.7\r\n   - docker run -d -p 10000:8888 -p 10001:8787 -p 10002:8786 --privileged=true --gpus all --name test -t test\r\n\r\n**Environment details**\r\n<details><summary>Click here to see environment details</summary><pre>\r\n     \r\n     **git***\r\n     commit 2cda39b34197c60614186ec51106d8254e5f7b05 (grafted, HEAD, origin/branch-0.16)\r\n     Author: Ray Douglass <3107146+raydouglass@users.noreply.github.com>\r\n     Date:   Wed Oct 21 10:31:49 2020 -0400\r\n     \r\n     Update CHANGELOG.md\r\n     **git submodules***\r\n     \r\n     ***OS Information***\r\n     DISTRIB_ID=Ubuntu\r\n     DISTRIB_RELEASE=18.04\r\n     DISTRIB_CODENAME=bionic\r\n     DISTRIB_DESCRIPTION=\"Ubuntu 18.04.5 LTS\"\r\n     NAME=\"Ubuntu\"\r\n     VERSION=\"18.04.5 LTS (Bionic Beaver)\"\r\n     ID=ubuntu\r\n     ID_LIKE=debian\r\n     PRETTY_NAME=\"Ubuntu 18.04.5 LTS\"\r\n     VERSION_ID=\"18.04\"\r\n     HOME_URL=\"https://www.ubuntu.com/\"\r\n     SUPPORT_URL=\"https://help.ubuntu.com/\"\r\n     BUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\r\n     PRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\r\n     VERSION_CODENAME=bionic\r\n     UBUNTU_CODENAME=bionic\r\n     Linux fe1b5c84b917 4.15.0-143-generic #147-Ubuntu SMP Wed Apr 14 16:10:11 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux\r\n     \r\n     ***GPU Information***\r\n     Tue Jun 22 15:01:51 2021\r\n     +-----------------------------------------------------------------------------+\r\n     | NVIDIA-SMI 455.23.05    Driver Version: 455.23.05    CUDA Version: 11.1     |\r\n     |-------------------------------+----------------------+----------------------+\r\n     | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n     | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n     |                               |                      |               MIG M. |\r\n     |===============================+======================+======================|\r\n     |   0  GeForce GTX 1080    On   | 00000000:05:00.0 Off |                  N/A |\r\n     | 28%   43C    P8     7W / 180W |   1504MiB /  8114MiB |      0%      Default |\r\n     |                               |                      |                  N/A |\r\n     +-------------------------------+----------------------+----------------------+\r\n     \r\n     +-----------------------------------------------------------------------------+\r\n     | Processes:                                                                  |\r\n     |  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\r\n     |        ID   ID                                                   Usage      |\r\n     |=============================================================================|\r\n     +-----------------------------------------------------------------------------+\r\n     \r\n     ***CPU***\r\n     Architecture:        x86_64\r\n     CPU op-mode(s):      32-bit, 64-bit\r\n     Byte Order:          Little Endian\r\n     CPU(s):              12\r\n     On-line CPU(s) list: 0-11\r\n     Thread(s) per core:  2\r\n     Core(s) per socket:  6\r\n     Socket(s):           1\r\n     NUMA node(s):        1\r\n     Vendor ID:           GenuineIntel\r\n     CPU family:          6\r\n     Model:               79\r\n     Model name:          Intel(R) Core(TM) i7-6800K CPU @ 3.40GHz\r\n     Stepping:            1\r\n     CPU MHz:             1200.861\r\n     CPU max MHz:         3800.0000\r\n     CPU min MHz:         1200.0000\r\n     BogoMIPS:            6800.53\r\n     Virtualization:      VT-x\r\n     L1d cache:           32K\r\n     L1i cache:           32K\r\n     L2 cache:            256K\r\n     L3 cache:            15360K\r\n     NUMA node0 CPU(s):   0-11\r\n     Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cdp_l3 invpcid_single pti intel_ppin ssbd ibrs ibpb stibp tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm rdt_a rdseed adx smap intel_pt xsaveopt cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts md_clear flush_l1d\r\n     \r\n     ***CMake***\r\n     \r\n     ***g++***\r\n     \r\n     ***nvcc***\r\n     \r\n     ***Python***\r\n     /opt/conda/envs/rapids/bin/python\r\n     Python 3.7.10\r\n     \r\n     ***Environment Variables***\r\n     PATH                            : /opt/conda/envs/rapids/bin:/opt/conda/condabin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n     LD_LIBRARY_PATH                 : /usr/local/nvidia/lib:/usr/local/nvidia/lib64\r\n     NUMBAPRO_NVVM                   :\r\n     NUMBAPRO_LIBDEVICE              :\r\n     CONDA_PREFIX                    : /opt/conda/envs/rapids\r\n     PYTHON_PATH                     :\r\n     \r\n     ***conda packages***\r\n     /opt/conda/condabin/conda\r\n     # packages in environment at /opt/conda/envs/rapids:\r\n     #\r\n     # Name                    Version                   Build  Channel\r\n     _libgcc_mutex             0.1                 conda_forge    conda-forge\r\n     _openmp_mutex             4.5                       1_gnu    conda-forge\r\n     abseil-cpp                20200225.2           he1b5a44_2    conda-forge\r\n     aiobotocore               1.2.1              pyhd8ed1ab_0    conda-forge\r\n     aiohttp                   3.7.4            py37h5e8e339_0    conda-forge\r\n     aioitertools              0.7.1              pyhd8ed1ab_0    conda-forge\r\n     appdirs                   1.4.4              pyh9f0ad1d_0    conda-forge\r\n     argon2-cffi               20.1.0           py37h5e8e339_2    conda-forge\r\n     arrow-cpp                 1.0.1           py37h2318771_14_cuda    conda-forge\r\n     arrow-cpp-proc            3.0.0                      cuda    conda-forge\r\n     async-timeout             3.0.1                   py_1000    conda-forge\r\n     async_generator           1.10                       py_0    conda-forge\r\n     attrs                     20.3.0             pyhd3deb0d_0    conda-forge\r\n     aws-c-common              0.4.59               h36c2ea0_1    conda-forge\r\n     aws-c-event-stream        0.1.6                had2084c_6    conda-forge\r\n     aws-checksums             0.1.10               h4e93380_0    conda-forge\r\n     aws-sdk-cpp               1.8.63               h9b98462_0    conda-forge\r\n     backcall                  0.2.0              pyh9f0ad1d_0    conda-forge\r\n     backports                 1.0                        py_2    conda-forge\r\n     backports.functools_lru_cache 1.6.1                      py_0    conda-forge\r\n     blas                      2.14                   openblas    conda-forge\r\n     blazingsql                0.18.0                   pypi_0    pypi\r\n     bleach                    3.3.0              pyh44b312d_0    conda-forge\r\n     bokeh                     2.2.3            py37h89c1867_0    conda-forge\r\n     boost                     1.72.0           py37h48f8a5e_1    conda-forge\r\n     boost-cpp                 1.72.0               h9d3c048_4    conda-forge\r\n     botocore                  1.19.52            pyhd8ed1ab_0    conda-forge\r\n     brotli                    1.0.9                h9c3ff4c_4    conda-forge\r\n     brotlipy                  0.7.0           py37h5e8e339_1001    conda-forge\r\n     bzip2                     1.0.8                h7f98852_4    conda-forge\r\n     c-ares                    1.17.1               h36c2ea0_0    conda-forge\r\n     ca-certificates           2020.12.5            ha878542_0    conda-forge\r\n     cairo                     1.16.0            h6cf1ce9_1008    conda-forge\r\n     certifi                   2020.12.5        py37h89c1867_1    conda-forge\r\n     cffi                      1.14.5           py37hc58025e_0    conda-forge\r\n     cfitsio                   3.470                h2e3daa1_7    conda-forge\r\n     cftime                    1.5.0                    pypi_0    pypi\r\n     chardet                   4.0.0            py37h89c1867_1    conda-forge\r\n     click                     7.1.2              pyh9f0ad1d_0    conda-forge\r\n     click-plugins             1.1.1                      py_0    conda-forge\r\n     cligj                     0.7.1              pyhd8ed1ab_0    conda-forge\r\n     cloudpickle               1.6.0                      py_0    conda-forge\r\n     colorcet                  2.0.6              pyhd8ed1ab_0    conda-forge\r\n     convertdate               2.3.2                    pypi_0    pypi\r\n     cryptography              3.4.4            py37hf1a17b8_0    conda-forge\r\n     cudatoolkit               10.1.243             h036e899_8    nvidia\r\n     cudf                      0.18.0          cuda_10.1_py37_g20778e5ddb_0    rapidsai\r\n     cudf_kafka                0.18.0          py37_g20778e5ddb_0    rapidsai\r\n     cudnn                     7.6.0                cuda10.1_0    nvidia\r\n     cugraph                   0.18.0          py37_g65ec965f_0    rapidsai\r\n     cuml                      0.18.0          cuda10.1_py37_gb5f59e005_0    rapidsai\r\n     cupy                      8.0.0            py37h0632833_0    conda-forge\r\n     curl                      7.71.1               he644dc0_8    conda-forge\r\n     cusignal                  0.18.0          py38_g42899d2_0    rapidsai\r\n     cuspatial                 0.18.0a210212   py37_g3045c48_21    rapidsai-nightly\r\n     custreamz                 0.18.0          py37_g20778e5ddb_0    rapidsai\r\n     cuxfilter                 0.18.0          py37_gac6f488_0    rapidsai\r\n     cycler                    0.10.0                     py_2    conda-forge\r\n     cyrus-sasl                2.1.27               h3274739_1    conda-forge\r\n     cython                    0.29.22          py37hcd2ae1e_0    conda-forge\r\n     cytoolz                   0.11.0           py37h5e8e339_3    conda-forge\r\n     dask                      2021.2.0           pyhd8ed1ab_0    conda-forge\r\n     dask-core                 2021.2.0           pyhd8ed1ab_0    conda-forge\r\n     dask-cuda                 0.18.0                   py37_0    rapidsai\r\n     dask-cudf                 0.18.0          py37_g20778e5ddb_0    rapidsai\r\n     dask-glm                  0.2.0                      py_1    conda-forge\r\n     dask-labextension         4.0.1              pyhd8ed1ab_0    conda-forge\r\n     dask-ml                   1.8.0              pyhd8ed1ab_0    conda-forge\r\n     datashader                0.11.1             pyh9f0ad1d_0    conda-forge\r\n     datashape                 0.5.4                      py_1    conda-forge\r\n     decorator                 4.4.2                      py_0    conda-forge\r\n     defusedxml                0.6.0                      py_0    conda-forge\r\n     distlib                   0.3.2                    pypi_0    pypi\r\n     distributed               2021.2.0         py37h89c1867_0    conda-forge\r\n     dlpack                    0.3                  he1b5a44_1    conda-forge\r\n     ecmwf-api-client          1.6.1                    pypi_0    pypi\r\n     entrypoints               0.3             pyhd8ed1ab_1003    conda-forge\r\n     ephem                     4.0.0.2                  pypi_0    pypi\r\n     expat                     2.2.10               h9c3ff4c_0    conda-forge\r\n     fa2                       0.3.5            py37h8f50634_0    conda-forge\r\n     faiss-proc                1.0.0                      cuda    conda-forge\r\n     fastavro                  1.3.4            py37h5e8e339_0    conda-forge\r\n     fastrlock                 0.5              py37hcd2ae1e_2    conda-forge\r\n     filelock                  3.0.12                   pypi_0    pypi\r\n     filterpy                  1.4.5                      py_1    conda-forge\r\n     fiona                     1.8.18           py37h527b4ca_0    conda-forge\r\n     flask                     2.0.1                    pypi_0    pypi\r\n     flask-wtf                 0.15.1                   pypi_0    pypi\r\n     fontconfig                2.13.1            hba837de_1004    conda-forge\r\n     freetype                  2.10.4               h0708190_1    conda-forge\r\n     freexl                    1.0.6                h7f98852_0    conda-forge\r\n     fsspec                    0.8.7              pyhd8ed1ab_0    conda-forge\r\n     future                    0.18.2           py37h89c1867_3    conda-forge\r\n     gdal                      3.1.4            py37h2ec2946_2    conda-forge\r\n     geopandas                 0.8.1                      py_0    conda-forge\r\n     geos                      3.8.1                he1b5a44_0    conda-forge\r\n     geotiff                   1.6.0                h5d11630_3    conda-forge\r\n     gettext                   0.19.8.1          h0b5b191_1005    conda-forge\r\n     gflags                    2.2.2             he1b5a44_1004    conda-forge\r\n     giflib                    5.2.1                h36c2ea0_2    conda-forge\r\n     git                       2.30.1          pl5320h6697202_1    conda-forge\r\n     glog                      0.4.0                h49b9bf7_3    conda-forge\r\n     gluonts                   0.7.6                    pypi_0    pypi\r\n     google-cloud-cpp          1.16.0               he4a878c_2    conda-forge\r\n     google-cloud-cpp-common   0.25.0               he83eced_7    conda-forge\r\n     googleapis-cpp            0.10.0               h6b1abdc_4    conda-forge\r\n     gpuci-tools               0.3.1                         0    gpuci\r\n     greenlet                  1.0.0            py37hcd2ae1e_0    conda-forge\r\n     grpc-cpp                  1.32.0               h7997a97_1    conda-forge\r\n     gunicorn                  20.1.0                   pypi_0    pypi\r\n     hdf4                      4.2.13            h10796ff_1004    conda-forge\r\n     hdf5                      1.10.6          nompi_h7c3c948_1111    conda-forge\r\n     heapdict                  1.0.1                      py_0    conda-forge\r\n     hijri-converter           2.1.2                    pypi_0    pypi\r\n     holidays                  0.11.1                   pypi_0    pypi\r\n     holoviews                 1.14.2             pyhd8ed1ab_0    conda-forge\r\n     icu                       68.1                 h58526e2_0    conda-forge\r\n     idna                      2.10               pyh9f0ad1d_0    conda-forge\r\n     importlib-metadata        3.7.0            py37h89c1867_0    conda-forge\r\n     importlib_metadata        3.7.0                hd8ed1ab_0    conda-forge\r\n     iniconfig                 1.1.1              pyh9f0ad1d_0    conda-forge\r\n     ipykernel                 5.5.0            py37h888b3d9_1    conda-forge\r\n     ipython                   7.15.0           py37hc8dfbb8_0    conda-forge\r\n     ipython_genutils          0.2.0                      py_1    conda-forge\r\n     ipywidgets                7.6.3              pyhd3deb0d_0    conda-forge\r\n     itsdangerous              2.0.1                    pypi_0    pypi\r\n     jedi                      0.17.2           py37h89c1867_1    conda-forge\r\n     jinja2                    3.0.1                    pypi_0    pypi\r\n     jmespath                  0.10.0             pyh9f0ad1d_0    conda-forge\r\n     joblib                    1.0.1              pyhd8ed1ab_0    conda-forge\r\n     jpeg                      9d                   h36c2ea0_0    conda-forge\r\n     jpype1                    1.2.1            py37h2527ec5_0    conda-forge\r\n     json-c                    0.13.1            hbfbb72e_1002    conda-forge\r\n     json5                     0.9.5              pyh9f0ad1d_0    conda-forge\r\n     jsonschema                3.2.0                      py_2    conda-forge\r\n     jupyter-server-proxy      1.6.0              pyhd8ed1ab_0    conda-forge\r\n     jupyter_client            6.1.11             pyhd8ed1ab_1    conda-forge\r\n     jupyter_core              4.7.1            py37h89c1867_0    conda-forge\r\n     jupyterlab                2.1.5                      py_0    conda-forge\r\n     jupyterlab-nvdashboard    0.1.11200212              py_12    rapidsai-nightly\r\n     jupyterlab_pygments       0.1.2              pyh9f0ad1d_0    conda-forge\r\n     jupyterlab_server         1.2.0                      py_0    conda-forge\r\n     jupyterlab_widgets        1.0.0              pyhd8ed1ab_1    conda-forge\r\n     kealib                    1.4.14               hcc255d8_2    conda-forge\r\n     kiwisolver                1.3.1            py37h2527ec5_1    conda-forge\r\n     korean-lunar-calendar     0.2.1                    pypi_0    pypi\r\n     krb5                      1.17.2               h926e7f8_0    conda-forge\r\n     lcms2                     2.12                 hddcbb42_0    conda-forge\r\n     ld_impl_linux-64          2.35.1               hea4e1c9_2    conda-forge\r\n     libblas                   3.8.0               14_openblas    conda-forge\r\n     libcblas                  3.8.0               14_openblas    conda-forge\r\n     libcrc32c                 1.1.1                h9c3ff4c_2    conda-forge\r\n     libcudf                   0.18.1          cuda10.1_g999be56c80_0    rapidsai\r\n     libcudf_kafka             0.18.0a210226   g1544474166_254    rapidsai-nightly\r\n     libcugraph                0.18.0          cuda10.1_g65ec965f_0    rapidsai\r\n     libcuml                   0.18.0          cuda10.1_gb5f59e005_0    rapidsai\r\n     libcumlprims              0.18.0a210211   cuda10.1_gff080f3_0    rapidsai-nightly\r\n     libcurl                   7.71.1               hcdd3856_8    conda-forge\r\n     libcuspatial              0.18.0          cuda10.1_gf4da460_0    rapidsai\r\n     libdap4                   3.20.6               hd7c4107_1    conda-forge\r\n     libedit                   3.1.20191231         he28a2e2_2    conda-forge\r\n     libev                     4.33                 h516909a_1    conda-forge\r\n     libevent                  2.1.10               hcdb4288_3    conda-forge\r\n     libfaiss                  1.6.3           he68dc02_3_cuda    conda-forge\r\n     libffi                    3.3                  h58526e2_2    conda-forge\r\n     libgcc-ng                 9.3.0               h2828fa1_18    conda-forge\r\n     libgcrypt                 1.9.2                h7f98852_0    conda-forge\r\n     libgdal                   3.1.4                h02eeb80_2    conda-forge\r\n     libgfortran-ng            7.5.0               h14aa051_18    conda-forge\r\n     libgfortran4              7.5.0               h14aa051_18    conda-forge\r\n     libglib                   2.68.0               h3e27bee_2    conda-forge\r\n     libgomp                   9.3.0               h2828fa1_18    conda-forge\r\n     libgpg-error              1.42                 h9c3ff4c_0    conda-forge\r\n     libgsasl                  1.8.0                         2    conda-forge\r\n     libhwloc                  2.3.0                h5e5b7d1_1    conda-forge\r\n     libiconv                  1.16                 h516909a_0    conda-forge\r\n     libkml                    1.3.0             hd79254b_1012    conda-forge\r\n     liblapack                 3.8.0               14_openblas    conda-forge\r\n     liblapacke                3.8.0               14_openblas    conda-forge\r\n     libllvm10                 10.0.1               he513fc3_3    conda-forge\r\n     libnetcdf                 4.7.4           nompi_h56d31a8_107    conda-forge\r\n     libnghttp2                1.43.0               h812cca2_0    conda-forge\r\n     libntlm                   1.4               h7f98852_1002    conda-forge\r\n     libopenblas               0.3.7                h5ec1e0e_6    conda-forge\r\n     libpng                    1.6.37               h21135ba_2    conda-forge\r\n     libpq                     12.3                 h255efa7_3    conda-forge\r\n     libprotobuf               3.13.0.1             h8b12597_0    conda-forge\r\n     librdkafka                1.5.3                h54cafa9_0    conda-forge\r\n     librmm                    0.18.0          cuda10.1_ga4ee6b7_0    rapidsai\r\n     librttopo                 1.1.0                hb271727_4    conda-forge\r\n     libsodium                 1.0.18               h36c2ea0_1    conda-forge\r\n     libspatialindex           1.9.3                h9c3ff4c_3    conda-forge\r\n     libspatialite             5.0.1                h6ec7341_0    conda-forge\r\n     libssh2                   1.9.0                hab1572f_5    conda-forge\r\n     libstdcxx-ng              9.3.0               h6de172a_18    conda-forge\r\n     libthrift                 0.13.0               h5aa387f_6    conda-forge\r\n     libtiff                   4.2.0                hdc55705_0    conda-forge\r\n     libutf8proc               2.6.1                h7f98852_0    conda-forge\r\n     libuuid                   2.32.1            h7f98852_1000    conda-forge\r\n     libuv                     1.41.0               h7f98852_0    conda-forge\r\n     libwebp                   1.2.0                h3452ae3_0    conda-forge\r\n     libwebp-base              1.2.0                h7f98852_0    conda-forge\r\n     libxcb                    1.13              h7f98852_1003    conda-forge\r\n     libxgboost                1.3.3dev.rapidsai0.18      cuda10.1_0    rapidsai-nightly\r\n     libxml2                   2.9.10               h72842e0_3    conda-forge\r\n     line-profiler             3.3.0                    pypi_0    pypi\r\n     llvmlite                  0.35.0           py37h9d7f4d0_1    conda-forge\r\n     locket                    0.2.0                      py_2    conda-forge\r\n     lz4-c                     1.9.2                he1b5a44_3    conda-forge\r\n     markdown                  3.3.4              pyhd8ed1ab_0    conda-forge\r\n     markupsafe                2.0.1                    pypi_0    pypi\r\n     matplotlib-base           3.3.4            py37h0c9df89_0    conda-forge\r\n     mistune                   0.8.4           py37h5e8e339_1003    conda-forge\r\n     more-itertools            8.7.0              pyhd8ed1ab_0    conda-forge\r\n     msgpack-python            1.0.2            py37h2527ec5_1    conda-forge\r\n     multidict                 5.1.0            py37h5e8e339_1    conda-forge\r\n     multipledispatch          0.6.0                      py_0    conda-forge\r\n     munch                     2.5.0                      py_0    conda-forge\r\n     mxnet-cu101               1.8.0                    pypi_0    pypi\r\n     nbclient                  0.5.3              pyhd8ed1ab_0    conda-forge\r\n     nbconvert                 6.0.7            py37h89c1867_3    conda-forge\r\n     nbformat                  5.1.2              pyhd8ed1ab_1    conda-forge\r\n     nccl                      2.8.4.1              h8b44402_3    conda-forge\r\n     ncurses                   6.2                  h58526e2_4    conda-forge\r\n     nest-asyncio              1.4.3              pyhd8ed1ab_0    conda-forge\r\n     netcdf4                   1.5.6                    pypi_0    pypi\r\n     netifaces                 0.10.9          py37h5e8e339_1003    conda-forge\r\n     networkx                  2.5                        py_0    conda-forge\r\n     nodejs                    14.15.4              h92b4a50_1    conda-forge\r\n     notebook                  6.2.0            py37h89c1867_0    conda-forge\r\n     numba                     0.52.0           py37hdc94413_0    conda-forge\r\n     numpy                     1.19.5           py37haa41c4c_1    conda-forge\r\n     nvtx                      0.2.3            py37h5e8e339_0    conda-forge\r\n     olefile                   0.46               pyh9f0ad1d_1    conda-forge\r\n     openjdk                   11.0.1            h516909a_1016    conda-forge\r\n     openjpeg                  2.4.0                hf7af979_0    conda-forge\r\n     openssl                   1.1.1k               h7f98852_0    conda-forge\r\n     orc                       1.6.5                hd3605a7_0    conda-forge\r\n     packaging                 20.9               pyh44b312d_0    conda-forge\r\n     pandas                    1.1.5            py37hdc94413_0    conda-forge\r\n     pandoc                    2.11.4               h7f98852_0    conda-forge\r\n     pandocfilters             1.4.2                      py_1    conda-forge\r\n     panel                     0.10.3             pyhd8ed1ab_0    conda-forge\r\n     param                     1.10.1             pyhd3deb0d_0    conda-forge\r\n     parquet-cpp               1.5.1                         2    conda-forge\r\n     parso                     0.7.1              pyh9f0ad1d_0    conda-forge\r\n     partd                     1.1.0                      py_0    conda-forge\r\n     patsy                     0.5.1                      py_0    conda-forge\r\n     pcre                      8.44                 he1b5a44_0    conda-forge\r\n     perl                      5.32.0               h36c2ea0_0    conda-forge\r\n     pexpect                   4.8.0              pyh9f0ad1d_2    conda-forge\r\n     pickle5                   0.0.11           py37h8f50634_0    conda-forge\r\n     pickleshare               0.7.5                   py_1003    conda-forge\r\n     pillow                    8.1.1            py37h4600e1f_0    conda-forge\r\n     pip                       21.0.1             pyhd8ed1ab_0    conda-forge\r\n     pipenv                    2021.5.29                pypi_0    pypi\r\n     pixman                    0.40.0               h36c2ea0_0    conda-forge\r\n     pluggy                    0.13.1           py37h89c1867_4    conda-forge\r\n     poppler                   0.89.0               h2de54a5_5    conda-forge\r\n     poppler-data              0.4.10                        0    conda-forge\r\n     postgresql                12.3                 hc2f5b80_3    conda-forge\r\n     proj                      7.1.1                h966b41f_3    conda-forge\r\n     prometheus_client         0.9.0              pyhd3deb0d_0    conda-forge\r\n     prompt-toolkit            3.0.16             pyha770c72_0    conda-forge\r\n     protobuf                  3.13.0.1         py37h745909e_1    conda-forge\r\n     psutil                    5.8.0            py37h5e8e339_1    conda-forge\r\n     pthread-stubs             0.4               h36c2ea0_1001    conda-forge\r\n     ptyprocess                0.7.0              pyhd3deb0d_0    conda-forge\r\n     pvlib                     0.8.1                    pypi_0    pypi\r\n     py                        1.10.0             pyhd3deb0d_0    conda-forge\r\n     py-xgboost                1.3.3dev.rapidsai0.18  cuda10.1py37_0    rapidsai-nightly\r\n     pyarrow                   1.0.1           py37hbeecfa9_14_cuda    conda-forge\r\n     pycparser                 2.20               pyh9f0ad1d_2    conda-forge\r\n     pyct                      0.4.6                      py_0    conda-forge\r\n     pyct-core                 0.4.6                      py_0    conda-forge\r\n     pydantic                  1.8.2                    pypi_0    pypi\r\n     pydeck                    0.5.0              pyh9f0ad1d_0    conda-forge\r\n     pyee                      7.0.4              pyh9f0ad1d_0    conda-forge\r\n     pyephem                   9.99                     pypi_0    pypi\r\n     pygments                  2.8.0              pyhd8ed1ab_0    conda-forge\r\n     pyhive                    0.6.3              pyhd3deb0d_0    conda-forge\r\n     pymeeus                   0.5.11                   pypi_0    pypi\r\n     pynndescent               0.5.2              pyh44b312d_0    conda-forge\r\n     pynvml                    8.0.4                      py_1    conda-forge\r\n     pyopenssl                 20.0.1             pyhd8ed1ab_0    conda-forge\r\n     pyparsing                 2.4.7              pyh9f0ad1d_0    conda-forge\r\n     pyppeteer                 0.2.2                      py_1    conda-forge\r\n     pyproj                    2.6.1.post1      py37h6415a23_3    conda-forge\r\n     pyrsistent                0.17.3           py37h5e8e339_2    conda-forge\r\n     pysocks                   1.7.1            py37h89c1867_3    conda-forge\r\n     pytest                    6.2.2            py37h89c1867_0    conda-forge\r\n     python                    3.7.10          hffdb5ce_100_cpython    conda-forge\r\n     python-confluent-kafka    1.5.0            py37h8f50634_0    conda-forge\r\n     python-dateutil           2.8.1                      py_0    conda-forge\r\n     python-graphviz           0.8.4                    pypi_0    pypi\r\n     python_abi                3.7                     1_cp37m    conda-forge\r\n     pytz                      2021.1             pyhd8ed1ab_0    conda-forge\r\n     pyviz_comms               2.0.1              pyhd3deb0d_0    conda-forge\r\n     pyyaml                    5.4.1            py37h5e8e339_0    conda-forge\r\n     pyzmq                     22.0.3           py37h336d617_1    conda-forge\r\n     rapids                    0.18.0a210302   cuda10.1_py37_g58c5d18_220    rapidsai-nightly\r\n     rapids-blazing            0.18.0a210302   cuda10.1_py37_g58c5d18_220    rapidsai-nightly\r\n     rapids-xgboost            0.18.0a210302   cuda10.1_py37_g58c5d18_220    rapidsai-nightly\r\n     re2                       2020.10.01           he1b5a44_0    conda-forge\r\n     readline                  8.0                  he28a2e2_2    conda-forge\r\n     requests                  2.25.1             pyhd3deb0d_0    conda-forge\r\n     rmm                       0.18.0          cuda_10.1_py37_ga4ee6b7_0    rapidsai\r\n     rtree                     0.9.7            py37h0b55af0_1    conda-forge\r\n     s2n                       1.0.0                h9b69904_0    conda-forge\r\n     s3fs                      0.5.2              pyhd8ed1ab_0    conda-forge\r\n     sasl                      0.2.1           py37h3340039_1002    conda-forge\r\n     scikit-learn              0.23.1           py37h8a51577_0    conda-forge\r\n     scipy                     1.5.3            py37h8911b10_0    conda-forge\r\n     seaborn                   0.11.1               hd8ed1ab_1    conda-forge\r\n     seaborn-base              0.11.1             pyhd8ed1ab_1    conda-forge\r\n     send2trash                1.5.0                      py_0    conda-forge\r\n     setuptools                49.6.0           py37h89c1867_3    conda-forge\r\n     shapely                   1.7.1            py37hba0730f_1    conda-forge\r\n     simpervisor               0.4                pyhd8ed1ab_0    conda-forge\r\n     six                       1.15.0             pyh9f0ad1d_0    conda-forge\r\n     snappy                    1.1.8                he1b5a44_3    conda-forge\r\n     sortedcontainers          2.3.0              pyhd8ed1ab_0    conda-forge\r\n     spdlog                    1.7.0                hc9558a2_2    conda-forge\r\n     sqlalchemy                1.4.3            py37h5e8e339_0    conda-forge\r\n     sqlite                    3.34.0               h74cdb3f_0    conda-forge\r\n     statsmodels               0.12.2           py37h902c9e0_0    conda-forge\r\n     streamz                   0.6.2              pyh44b312d_0    conda-forge\r\n     tbb                       2020.2               h4bd325d_3    conda-forge\r\n     tblib                     1.6.0                      py_0    conda-forge\r\n     terminado                 0.9.2            py37h89c1867_0    conda-forge\r\n     testpath                  0.4.4                      py_0    conda-forge\r\n     threadpoolctl             2.1.0              pyh5ca1d4c_0    conda-forge\r\n     thrift                    0.13.0           py37hcd2ae1e_2    conda-forge\r\n     thrift_sasl               0.4.2            py37h8f50634_0    conda-forge\r\n     tiledb                    2.1.6                h1022b9d_0    conda-forge\r\n     tk                        8.6.10               h21135ba_1    conda-forge\r\n     toml                      0.10.2             pyhd8ed1ab_0    conda-forge\r\n     toolz                     0.11.1                     py_0    conda-forge\r\n     tornado                   6.1              py37h5e8e339_1    conda-forge\r\n     tqdm                      4.58.0             pyhd8ed1ab_0    conda-forge\r\n     traitlets                 5.0.5                      py_0    conda-forge\r\n     treelite                  1.0.0            py37hc731546_0    conda-forge\r\n     treelite-runtime          1.0.0                    pypi_0    pypi\r\n     typing-extensions         3.7.4.3                       0    conda-forge\r\n     typing_extensions         3.7.4.3                    py_0    conda-forge\r\n     tzcode                    2021a                h7f98852_1    conda-forge\r\n     ucx                       1.9.0+gcd9efd3       cuda10.1_0    rapidsai-nightly\r\n     ucx-proc                  1.0.0                       gpu    rapidsai-nightly\r\n     ucx-py                    0.18.0a210323   py37_gcd9efd3_19    rapidsai-nightly\r\n     umap-learn                0.5.1            py37h89c1867_0    conda-forge\r\n     urllib3                   1.26.3             pyhd8ed1ab_0    conda-forge\r\n     virtualenv                20.4.7                   pypi_0    pypi\r\n     virtualenv-clone          0.5.4                    pypi_0    pypi\r\n     wcwidth                   0.2.5              pyh9f0ad1d_2    conda-forge\r\n     webencodings              0.5.1                      py_1    conda-forge\r\n     websockets                8.1              py37h5e8e339_3    conda-forge\r\n     werkzeug                  2.0.1                    pypi_0    pypi\r\n     wheel                     0.36.2             pyhd3deb0d_0    conda-forge\r\n     widgetsnbextension        3.5.1            py37h89c1867_4    conda-forge\r\n     wrapt                     1.12.1           py37h5e8e339_3    conda-forge\r\n     wtforms                   2.3.3                    pypi_0    pypi\r\n     xarray                    0.17.0             pyhd8ed1ab_0    conda-forge\r\n     xerces-c                  3.2.3                h9d8b166_2    conda-forge\r\n     xgboost                   1.3.3dev.rapidsai0.18  cuda10.1py37_0    rapidsai-nightly\r\n     xorg-kbproto              1.0.7             h7f98852_1002    conda-forge\r\n     xorg-libice               1.0.10               h7f98852_0    conda-forge\r\n     xorg-libsm                1.2.3             hd9c2040_1000    conda-forge\r\n     xorg-libx11               1.7.0                h7f98852_0    conda-forge\r\n     xorg-libxau               1.0.9                h7f98852_0    conda-forge\r\n     xorg-libxdmcp             1.1.3                h7f98852_0    conda-forge\r\n     xorg-libxext              1.3.4                h7f98852_1    conda-forge\r\n     xorg-libxrender           0.9.10            h7f98852_1003    conda-forge\r\n     xorg-renderproto          0.11.1            h7f98852_1002    conda-forge\r\n     xorg-xextproto            7.3.0             h7f98852_1002    conda-forge\r\n     xorg-xproto               7.0.31            h7f98852_1007    conda-forge\r\n     xz                        5.2.5                h516909a_1    conda-forge\r\n     yaml                      0.2.5                h516909a_0    conda-forge\r\n     yarl                      1.6.3            py37h5e8e339_1    conda-forge\r\n     zeromq                    4.3.4                h9c3ff4c_0    conda-forge\r\n     zict                      2.0.0                      py_0    conda-forge\r\n     zipp                      3.4.0                      py_0    conda-forge\r\n     zlib                      1.2.11            h516909a_1010    conda-forge\r\n     zstd                      1.4.8                hdf46e1d_0    conda-forge\r\n     \r\n</pre></details>","closed":false,"closedAt":null,"comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg2NjEzMjcyOQ==","author":{"login":"beckernick"},"authorAssociation":"MEMBER","body":"Thanks for including a simple reproducer gist. I've included it below for ease of access.\r\n\r\n```python\r\nimport pandas as pd\r\nimport cudf\r\nimport numpy as np\r\n​\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 00:00+0000',  '%Y-%m-%d %H:%M%z'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 03:00+0000',  '%Y-%m-%d %H:%M%z'))\r\ntimestamps = pd.date_range(start, end, freq='1H')\r\nlabels = ['A', 'B', 'C']\r\nindex = pd.MultiIndex.from_product([timestamps, labels], names=[\"timestamp\", \"label\"])\r\nvalue = np.random.normal(size=12)\r\ndf = pd.DataFrame(value, index=index, columns=['value'])\r\ndf_gpu = cudf.from_pandas(df)\r\n​\r\nstamp = pd.Timestamp(datetime.strptime('2021-03-12 02:00+0000',  '%Y-%m-%d %H:%M%z'))\r\n​\r\nprint(df.loc[stamp]) # SUCCEEDS\r\nprint(df_gpu.loc[stamp]) # FAILS\r\n          value\r\nlabel          \r\nA      1.184793\r\nB     -0.253166\r\nC     -0.790236\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/indexing.py in __getitem__(self, arg)\r\n    234             try:\r\n--> 235                 return self._getitem_tuple_arg(arg)\r\n    236             except (TypeError, KeyError, IndexError, ValueError):\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/contextlib.py in inner(*args, **kwds)\r\n     74             with self._recreate_cm():\r\n---> 75                 return func(*args, **kwds)\r\n     76         return inner\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/indexing.py in _getitem_tuple_arg(self, arg)\r\n    360                 else:\r\n--> 361                     return columns_df.index._get_row_major(columns_df, arg)\r\n    362         else:\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/multiindex.py in _get_row_major(self, df, row_tuple)\r\n    926                 row_tuple = slice(row_tuple.start, self[-1], row_tuple.step)\r\n--> 927         self._validate_indexer(row_tuple)\r\n    928         valid_indices = self._get_valid_indices_by_tuple(\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/multiindex.py in _validate_indexer(self, indexer)\r\n    958         else:\r\n--> 959             for i in indexer:\r\n    960                 self._validate_indexer(i)\r\n\r\nTypeError: 'Timestamp' object is not iterable\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-87-fe779946243b> in <module>\r\n     15 \r\n     16 print(df.loc[stamp]) # SUCCEEDS\r\n---> 17 print(df_gpu.loc[stamp]) # FAILS\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/indexing.py in __getitem__(self, arg)\r\n    235                 return self._getitem_tuple_arg(arg)\r\n    236             except (TypeError, KeyError, IndexError, ValueError):\r\n--> 237                 return self._getitem_tuple_arg((arg, slice(None)))\r\n    238         else:\r\n    239             if not isinstance(arg, tuple):\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/contextlib.py in inner(*args, **kwds)\r\n     73         def inner(*args, **kwds):\r\n     74             with self._recreate_cm():\r\n---> 75                 return func(*args, **kwds)\r\n     76         return inner\r\n     77 \r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/indexing.py in _getitem_tuple_arg(self, arg)\r\n    357             else:\r\n    358                 if isinstance(arg, tuple):\r\n--> 359                     return columns_df.index._get_row_major(columns_df, arg[0])\r\n    360                 else:\r\n    361                     return columns_df.index._get_row_major(columns_df, arg)\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/multiindex.py in _get_row_major(self, df, row_tuple)\r\n    925             if row_tuple.stop is None:\r\n    926                 row_tuple = slice(row_tuple.start, self[-1], row_tuple.step)\r\n--> 927         self._validate_indexer(row_tuple)\r\n    928         valid_indices = self._get_valid_indices_by_tuple(\r\n    929             df.index, row_tuple, len(df.index)\r\n\r\n/raid/nicholasb/miniconda3/envs/rapids-21.08/lib/python3.8/site-packages/cudf/core/multiindex.py in _validate_indexer(self, indexer)\r\n    957             self._validate_indexer(indexer.stop)\r\n    958         else:\r\n--> 959             for i in indexer:\r\n    960                 self._validate_indexer(i)\r\n    961 \r\n\r\nTypeError: 'Timestamp' object is not iterable\r\n```\r\n\r\nIt looks like we go down a codepath that expects an iterable, which explains why wrapping with a tuple works (and may resolve your problem in the short term):\r\n\r\n```python\r\nprint(df_gpu.loc[(stamp,)]) # SUCCEEDS\r\n          value\r\nlabel          \r\nA      1.184793\r\nB     -0.253166\r\nC     -0.790236\r\n```","createdAt":"2021-06-22T16:21:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-866132729","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg2NzA0MTAyOA==","author":{"login":"pbruneau"},"authorAssociation":"NONE","body":"Hi @beckernick, thanks for the answer!\r\n\r\nThe \"tuple trick\" above seems to do the job for accessing a single value. However, I'm back into trouble if I want to fetch values for a timestamp range.\r\n\r\nElaborating from my previous gist example, if I type:\r\n\r\n```\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 01:00+0000',  '%Y-%m-%d %H:%M%z'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 02:00+0000',  '%Y-%m-%d %H:%M%z'))\r\nprint(df.loc[start:end])\r\n```\r\n\r\nI get the expected result:\r\n\r\n```\r\n                                    value\r\ntimestamp                 label          \r\n2021-03-12 01:00:00+00:00 A     -0.466112\r\n                          B     -0.781473\r\n                          C     -1.010174\r\n2021-03-12 02:00:00+00:00 A      0.160179\r\n                          B      1.007183\r\n                          C     -1.053772\r\n```\r\n\r\nWith cuDF, the following gets the usual `TypeError: 'Timestamp' object is not iterable`:\r\n\r\n```\r\nprint(df_gpu.loc[start:end])\r\n```\r\n\r\nAlternatively, trying:\r\n\r\n```\r\nprint(df_gpu.loc[(start:end,)])\r\n```\r\n\r\ngets a `SyntaxError: invalid syntax`. Using a _regular_ Timestamp range with:\r\n\r\n```\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 01:00+0000',  '%Y-%m-%d %H:%M%z'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 02:00+0000',  '%Y-%m-%d %H:%M%z'))\r\ntimestamps = pd.date_range(start, end, freq='1H')\r\nprint(df_gpu.loc[(timestamps,)])\r\n```\r\n\r\nI get `ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()`. Any idea for circumventing this issue?","createdAt":"2021-06-23T17:52:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-867041028","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3NzYzNjE2Nw==","author":{"login":"pbruneau"},"authorAssociation":"NONE","body":"Hi,\r\n\r\nI'm following up about the bug reported above,\r\nas reported in my last answer, using a tuple to access a Timestamp first level of a MultiIndex circumvents the issue pointed out initially,\r\nbut the proposed solution fails if one wants to access a Timestamp range.\r\n\r\nI realize that the title is not accurately reflecting the actually remaining bug: should I create a new issue which singles out the Timestamp range bug, or rename this one?","createdAt":"2021-07-10T13:14:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-877636167","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps440HsN","author":{"login":"beckernick"},"authorAssociation":"MEMBER","body":"We've been refactoring our MultiIndex implementation to help make it more efficient and maintainable. Is the pandas snippet in the comment above a minimal example of the desired behavior @pbruneau ?","createdAt":"2021-10-27T18:12:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-953187085","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps45FF9r","author":{"login":"pbruneau"},"authorAssociation":"NONE","body":"Hi @beckernick,\r\n\r\n[Here is an updated minimal gist](https://gist.github.com/pbruneau/53312fe4bef649b7780f8f63bf09fbe1) which lists in details what works, does not work, and workarounds (as of version 21.08.02 installed on my side).\r\n\r\nIn a nutshell (please refer to the gist for details): with a MultiIndex and timestamps as primary key, pandas allows to do this kind of operation:\r\n\r\n```\r\ndf.loc[stamp]\r\ndf.loc[timestamps]\r\n```\r\nwith `stamp` and `timestamps` valid timestamp and timestamp range, respectively. I would like to do the same with cudf, but as of v21.08.02, it is impossible.","createdAt":"2021-11-02T13:59:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-957636459","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps49JBKU","author":{"login":"github-actions"},"authorAssociation":"NONE","body":"This issue has been labeled `inactive-90d` due to no recent activity in the past 90 days. Please close this issue if no further response or action is needed. Otherwise, please respond with a comment indicating any updates or changes to the original issue and/or confirm this issue still needs to be addressed.","createdAt":"2022-01-31T14:07:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-1025774228","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps49RL38","author":{"login":"pbruneau"},"authorAssociation":"NONE","body":"The problems reported above and highlighted [in this minimal gist](https://gist.github.com/pbruneau/53312fe4bef649b7780f8f63bf09fbe1) still occur with v21.12, with exactly the same error messages.","createdAt":"2022-02-02T12:57:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-1027915260","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5bTKQ7","author":{"login":"wence-"},"authorAssociation":"CONTRIBUTOR","body":"An update here (I am working through many indexing corner cases), apologies for the very slow responses.\r\n\r\nIn 23.06 (the current development version) there is an error constructing time-zone aware timestamps (previously they were accepted but handled incorrectly, now they are not accepted, soon they will be accepted and handled correctly). However, if I remove the timezone portion of the timestamps, then only your last example now fails (I reproduce here for posterity):\r\n```python\r\nimport pandas as pd\r\nfrom datetime import datetime\r\nimport cudf\r\nimport numpy as np\r\n\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 00:00',  '%Y-%m-%d %H:%M'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 03:00',  '%Y-%m-%d %H:%M'))\r\ntimestamps = pd.date_range(start, end, freq='1H')\r\nlabels = ['A', 'B', 'C']\r\nindex = pd.MultiIndex.from_product([timestamps, labels], names=[\"timestamp\", \"label\"])\r\nvalue = np.random.normal(size=12)\r\ndf = pd.DataFrame(value, index=index, columns=['value'])\r\n\r\ndf_gpu = cudf.from_pandas(df)\r\n\r\nstart = pd.Timestamp(datetime.strptime('2021-03-12 01:00',  '%Y-%m-%d %H:%M'))\r\nend = pd.Timestamp(datetime.strptime('2021-03-12 02:00',  '%Y-%m-%d %H:%M'))\r\ntimestamps = pd.date_range(start, end, freq='1H')\r\n\r\n# SUCCEEDS\r\nprint(df.loc[timestamps])\r\n\r\n# FAILS\r\nprint(df_gpu.loc[timestamps])\r\n\r\n# indexing with a slice range also fails in this case.\r\ndf_gpu.loc[start:end] # Fails\r\n```","createdAt":"2023-05-02T16:13:46Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-1531749435","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5bWC2N","author":{"login":"pbruneau"},"authorAssociation":"NONE","body":"Hi @wence-,\r\n\r\nI'm installing via Docker, so I can't check out by myself (23.06 does not seem to be available then),\r\n\r\nIf I get it right, this means that:\r\n```\r\nprint(df_gpu.loc[timestamps])\r\n```\r\nworks fine? I would already have a workaround, then!","createdAt":"2023-05-03T06:29:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-1532505485","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5bWn-F","author":{"login":"wence-"},"authorAssociation":"CONTRIBUTOR","body":"> Hi @wence-,\r\n> \r\n> I'm installing via Docker, so I can't check out by myself (23.06 does not seem to be available then),\r\n> \r\n> If I get it right, this means that:\r\n> \r\n> ```\r\n> print(df_gpu.loc[timestamps])\r\n> ```\r\n> \r\n> works fine? I would already have a workaround, then!\r\n\r\nIf your dataframe has a multiindex, that example does not _yet_ work. If you just have a normal index, it does work.","createdAt":"2023-05-03T08:44:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-1532657541","viewerDidAuthor":false},{"id":"IC_kwDOBWUGps5bXFyN","author":{"login":"pbruneau"},"authorAssociation":"NONE","body":"> > Hi @wence-,\r\n> > I'm installing via Docker, so I can't check out by myself (23.06 does not seem to be available then),\r\n> > If I get it right, this means that:\r\n> > ```\r\n> > print(df_gpu.loc[timestamps])\r\n> > ```\r\n> > \r\n> > \r\n> >     \r\n> >       \r\n> >     \r\n> > \r\n> >       \r\n> >     \r\n> > \r\n> >     \r\n> >   \r\n> > works fine? I would already have a workaround, then!\r\n> \r\n> If your dataframe has a multiindex, that example does not _yet_ work. If you just have a normal index, it does work.\r\n\r\nOK! Good luck with the development then (even if luck has nothing to do with it :)","createdAt":"2023-05-03T10:19:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/rapidsai/cudf/issues/8585#issuecomment-1532779661","viewerDidAuthor":false}],"createdAt":"2021-06-22T15:07:25Z","id":"MDU6SXNzdWU5MjczMzg3Mjc=","labels":[{"id":"MDU6TGFiZWw1OTk2MjY1NTk=","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxMTM5NzQxMjEz","name":"cuDF (Python)","description":"Affects Python cuDF API.","color":"1d76db"}],"milestone":{"number":1,"title":"Time Series Analysis","description":"","dueOn":null},"number":8585,"projectCards":[],"projectItems":[],"reactionGroups":[],"state":"OPEN","title":"[BUG] MultiIndex loc expects an iterable when passed Timestamp","updatedAt":"2023-05-03T10:19:41Z","url":"https://github.com/rapidsai/cudf/issues/8585"}
